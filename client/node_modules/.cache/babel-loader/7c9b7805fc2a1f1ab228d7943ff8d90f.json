{"ast":null,"code":"var _jsxFileName = \"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ShoppingCart/CartRow.jsx\";\nimport React from \"react\";\nimport { ACCESS_LEVEL_GUEST, SERVER_HOST } from \"../../config/global_constants\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport { Trash } from \"react-bootstrap-icons\";\nimport { Carousel } from \"react-bootstrap\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass CartRow extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleIncreaseQuantity = e => {\n      if (this.state.quantity === this.state.stock) {\n        Swal.fire({\n          title: \"Product not added\",\n          text: \"Not enough stock\",\n          icon: \"error\",\n          showConfirmButton: true,\n          confirmButtonColor: \"#123c69\"\n        });\n      } else {\n        if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n          axios.put(`${SERVER_HOST}/cart/increaseQuantity/${this.props.item._id}/${this.state._id}`).then(res => {\n            window.location.reload(false);\n          });\n        } else {\n          let curCart = JSON.parse(localStorage.cart);\n          curCart.forEach(item => {\n            if (item.productId === this.props.item.productId) {\n              item.quantity++;\n              window.location.reload(false);\n            }\n          });\n          localStorage.cart = JSON.stringify(curCart);\n        }\n      }\n    };\n\n    this.handleDecreaseQuantity = e => {\n      if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n        if (this.state.quantity > 1) {\n          axios.put(`${SERVER_HOST}/cart/decreaseQuantity/${this.props.item._id}/${this.state._id}`).then(res => {\n            window.location.reload(false);\n          });\n        } else {\n          const MySwal = Swal.mixin({\n            customClass: {\n              confirmButton: \"btn btn-success mr-2\",\n              cancelButton: \"btn btn-danger ml-2\"\n            },\n            buttonsStyling: false\n          });\n          MySwal.fire({\n            title: \"Remove item from shopping cart?\",\n            icon: \"warning\",\n            showCancelButton: true,\n            confirmButtonColor: \"#5cb85c\",\n            cancelButtonColor: \"#d33\",\n            confirmButtonText: \"Yes, delete it!\"\n          }).then(result => {\n            if (result.isConfirmed) {\n              axios.delete(`${SERVER_HOST}/cart/decreaseQuantity/${this.props.item._id}/${this.state._id}`).then(res => {\n                window.location.reload(false);\n              });\n            }\n          });\n        }\n      } else {\n        if (this.state.quantity > 1) {\n          let curCart = JSON.parse(localStorage.cart);\n          curCart.map(item => {\n            if (item.productId === this.props.item.productId) {\n              item.quantity--;\n              window.location.reload(false);\n            }\n          });\n          localStorage.cart = JSON.stringify(curCart);\n        } else {\n          const MySwal = Swal.mixin({\n            customClass: {\n              confirmButton: \"btn btn-success mr-2\",\n              cancelButton: \"btn btn-danger ml-2\"\n            },\n            buttonsStyling: false\n          });\n          MySwal.fire({\n            title: \"Remove item from shopping cart?\",\n            icon: \"warning\",\n            showCancelButton: true,\n            confirmButtonColor: \"#5cb85c\",\n            cancelButtonColor: \"#d33\",\n            confirmButtonText: \"Yes, delete it!\"\n          }).then(result => {\n            if (result.isConfirmed) {\n              let index = 0;\n              let curCart = JSON.parse(localStorage.cart);\n              curCart.map((item, i) => {\n                if (item.productId === this.props.item.productId) {\n                  index = i;\n                }\n              });\n              curCart.splice(index, 1);\n              localStorage.cart = JSON.stringify(curCart);\n              window.location.reload(false);\n            }\n          });\n        }\n      }\n    };\n\n    this.handleRemoveItem = e => {\n      axios.delete(`${SERVER_HOST}/cart/${this.state.cartId}`).then(res => {\n        const MySwal = Swal.mixin({\n          customClass: {\n            confirmButton: \"btn btn-success mr-2\",\n            cancelButton: \"btn btn-danger ml-2\"\n          },\n          buttonsStyling: false\n        });\n        MySwal.fire({\n          title: \"Remove item from shopping cart?\",\n          icon: \"warning\",\n          showCancelButton: true,\n          confirmButtonColor: \"#5cb85c\",\n          cancelButtonColor: \"#d33\",\n          confirmButtonText: \"Yes, delete it!\"\n        }).then(result => {\n          if (result.isConfirmed) {\n            if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n              axios.delete(`${SERVER_HOST}/cart/${this.state.cartId}}`).then(res => {\n                window.location.reload(false);\n              });\n            } else {\n              let index = 0;\n              let curCart = JSON.parse(localStorage.cart);\n              curCart.forEach((item, i) => {\n                if (item.productId === this.props.item.productId) {\n                  index = i;\n                }\n              });\n              curCart.splice(index, 1);\n              localStorage.cart = JSON.stringify(curCart);\n              window.location.reload(false);\n            }\n          }\n        });\n      });\n    };\n\n    this.state = {\n      productName: \"\",\n      price: \"\",\n      _id: \"\",\n      quantity: this.props.item.quantity,\n      totalPrice: 0,\n      cartItem: \"\",\n      stock: 0,\n      photos: []\n    };\n  }\n\n  componentDidMount() {\n    axios.get(`${SERVER_HOST}/products/${this.props.item.productId}`).then(res => {\n      if (res.data) {\n        if (res.data.errorMessage) {\n          console.log(res.data.errorMessage);\n        } else {\n          this.setState({\n            _id: res.data._id,\n            productName: res.data.productName,\n            price: res.data.price,\n            totalPrice: res.data.price * this.state.quantity,\n            stock: res.data.stock,\n            photos: res.data.photos\n          });\n          res.data.photos.map(photo => {\n            return axios.get(`${SERVER_HOST}/products/photo/${photo.filename}`).then(res => {\n              if (res.data) {\n                if (res.data.errorMessage) {\n                  console.log(res.data.errorMessage);\n                } else {\n                  document.getElementById(photo._id).src = `data:;base64,${res.data.image}`;\n                }\n              } else {\n                console.log(\"Record not found\");\n              }\n            });\n          });\n        }\n      } else {\n        console.log(`Product not found`);\n      }\n    });\n\n    if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n      axios.get(`${SERVER_HOST}/cart/${this.props.item.productId}/${localStorage._id}`).then(res => {\n        if (res.data) {\n          this.setState({\n            cartId: res.data._id\n          });\n          this.setState({\n            quantity: res.data.quantity\n          });\n        }\n      });\n    } else {\n      JSON.parse(localStorage.cart).map(item => {\n        if (item.productId === this.props.item.productId) {\n          this.setState({\n            cartId: item._id\n          });\n          this.setState({\n            quantity: item.quantity\n          });\n        }\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product border-bottom mt-0 mb-2\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-3\",\n          children: /*#__PURE__*/_jsxDEV(Carousel, {\n            nextLabel: \"\",\n            prevLabel: \"\",\n            indicators: false,\n            children: this.state.photos.map(photo => /*#__PURE__*/_jsxDEV(Carousel.Item, {\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                className: \"rounded\",\n                id: photo._id\n              }, photo._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 19\n              }, this)\n            }, photo._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-5\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: /*#__PURE__*/_jsxDEV(\"h6\", {\n                    children: this.state.productName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 258,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 257,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-4 quantity\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Quantity:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 263,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn rounded-circle mr-3\",\n                  onClick: this.handleDecreaseQuantity,\n                  children: \"-\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 19\n                }, this), this.state.quantity, /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn rounded-circle ml-3\",\n                    onClick: this.handleIncreaseQuantity,\n                    children: \"+\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 273,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-3 price\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"\\u20AC\", (Math.round(this.state.totalPrice * 100) / 100).toFixed(2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Trash, {\n                  onClick: this.handleRemoveItem,\n                  className: \"ml-3 cursor-pointer\",\n                  color: \"#787878\",\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default CartRow;","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ShoppingCart/CartRow.jsx"],"names":["React","ACCESS_LEVEL_GUEST","SERVER_HOST","axios","Swal","Trash","Carousel","CartRow","Component","constructor","props","handleIncreaseQuantity","e","state","quantity","stock","fire","title","text","icon","showConfirmButton","confirmButtonColor","localStorage","accessLevel","parseInt","put","item","_id","then","res","window","location","reload","curCart","JSON","parse","cart","forEach","productId","stringify","handleDecreaseQuantity","MySwal","mixin","customClass","confirmButton","cancelButton","buttonsStyling","showCancelButton","cancelButtonColor","confirmButtonText","result","isConfirmed","delete","map","index","i","splice","handleRemoveItem","cartId","productName","price","totalPrice","cartItem","photos","componentDidMount","get","data","errorMessage","console","log","setState","photo","filename","document","getElementById","src","image","render","Math","round","toFixed"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { ACCESS_LEVEL_GUEST, SERVER_HOST } from \"../../config/global_constants\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport { Trash } from \"react-bootstrap-icons\";\nimport { Carousel } from \"react-bootstrap\";\n\nclass CartRow extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      productName: \"\",\n      price: \"\",\n      _id: \"\",\n      quantity: this.props.item.quantity,\n      totalPrice: 0,\n      cartItem: \"\",\n      stock: 0,\n      photos: [],\n    };\n  }\n\n  componentDidMount() {\n    axios\n      .get(`${SERVER_HOST}/products/${this.props.item.productId}`)\n      .then((res) => {\n        if (res.data) {\n          if (res.data.errorMessage) {\n            console.log(res.data.errorMessage);\n          } else {\n            this.setState({\n              _id: res.data._id,\n              productName: res.data.productName,\n              price: res.data.price,\n              totalPrice: res.data.price * this.state.quantity,\n              stock: res.data.stock,\n              photos: res.data.photos,\n            });\n\n            res.data.photos.map((photo) => {\n              return axios\n                .get(`${SERVER_HOST}/products/photo/${photo.filename}`)\n                .then((res) => {\n                  if (res.data) {\n                    if (res.data.errorMessage) {\n                      console.log(res.data.errorMessage);\n                    } else {\n                      document.getElementById(\n                        photo._id\n                      ).src = `data:;base64,${res.data.image}`;\n                    }\n                  } else {\n                    console.log(\"Record not found\");\n                  }\n                });\n            });\n          }\n        } else {\n          console.log(`Product not found`);\n        }\n      });\n\n    if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n      axios\n        .get(\n          `${SERVER_HOST}/cart/${this.props.item.productId}/${localStorage._id}`\n        )\n        .then((res) => {\n          if (res.data) {\n            this.setState({ cartId: res.data._id });\n            this.setState({ quantity: res.data.quantity });\n          }\n        });\n    } else {\n      JSON.parse(localStorage.cart).map((item) => {\n        if (item.productId === this.props.item.productId) {\n          this.setState({ cartId: item._id });\n          this.setState({ quantity: item.quantity });\n        }\n      });\n    }\n  }\n\n  handleIncreaseQuantity = (e) => {\n    if (this.state.quantity === this.state.stock) {\n      Swal.fire({\n        title: \"Product not added\",\n        text: \"Not enough stock\",\n        icon: \"error\",\n        showConfirmButton: true,\n        confirmButtonColor: \"#123c69\",\n      });\n    } else {\n      if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n        axios\n          .put(\n            `${SERVER_HOST}/cart/increaseQuantity/${this.props.item._id}/${this.state._id}`\n          )\n          .then((res) => {\n            window.location.reload(false);\n          });\n      } else {\n        let curCart = JSON.parse(localStorage.cart);\n        curCart.forEach((item) => {\n          if (item.productId === this.props.item.productId) {\n            item.quantity++;\n            window.location.reload(false);\n          }\n        });\n\n        localStorage.cart = JSON.stringify(curCart);\n      }\n    }\n  };\n\n  handleDecreaseQuantity = (e) => {\n    if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n      if (this.state.quantity > 1) {\n        axios\n          .put(\n            `${SERVER_HOST}/cart/decreaseQuantity/${this.props.item._id}/${this.state._id}`\n          )\n          .then((res) => {\n            window.location.reload(false);\n          });\n      } else {\n        const MySwal = Swal.mixin({\n          customClass: {\n            confirmButton: \"btn btn-success mr-2\",\n            cancelButton: \"btn btn-danger ml-2\",\n          },\n          buttonsStyling: false,\n        });\n\n        MySwal.fire({\n          title: \"Remove item from shopping cart?\",\n          icon: \"warning\",\n          showCancelButton: true,\n          confirmButtonColor: \"#5cb85c\",\n          cancelButtonColor: \"#d33\",\n          confirmButtonText: \"Yes, delete it!\",\n        }).then((result) => {\n          if (result.isConfirmed) {\n            axios\n              .delete(\n                `${SERVER_HOST}/cart/decreaseQuantity/${this.props.item._id}/${this.state._id}`\n              )\n              .then((res) => {\n                window.location.reload(false);\n              });\n          }\n        });\n      }\n    } else {\n      if (this.state.quantity > 1) {\n        let curCart = JSON.parse(localStorage.cart);\n        curCart.map((item) => {\n          if (item.productId === this.props.item.productId) {\n            item.quantity--;\n            window.location.reload(false);\n          }\n        });\n        localStorage.cart = JSON.stringify(curCart);\n      } else {\n        const MySwal = Swal.mixin({\n          customClass: {\n            confirmButton: \"btn btn-success mr-2\",\n            cancelButton: \"btn btn-danger ml-2\",\n          },\n          buttonsStyling: false,\n        });\n\n        MySwal.fire({\n          title: \"Remove item from shopping cart?\",\n          icon: \"warning\",\n          showCancelButton: true,\n          confirmButtonColor: \"#5cb85c\",\n          cancelButtonColor: \"#d33\",\n          confirmButtonText: \"Yes, delete it!\",\n        }).then((result) => {\n          if (result.isConfirmed) {\n            let index = 0;\n            let curCart = JSON.parse(localStorage.cart);\n            curCart.map((item, i) => {\n              if (item.productId === this.props.item.productId) {\n                index = i;\n              }\n            });\n            curCart.splice(index, 1);\n            localStorage.cart = JSON.stringify(curCart);\n            window.location.reload(false);\n          }\n        });\n      }\n    }\n  };\n\n  handleRemoveItem = (e) => {\n    axios.delete(`${SERVER_HOST}/cart/${this.state.cartId}`).then((res) => {\n      const MySwal = Swal.mixin({\n        customClass: {\n          confirmButton: \"btn btn-success mr-2\",\n          cancelButton: \"btn btn-danger ml-2\",\n        },\n        buttonsStyling: false,\n      });\n\n      MySwal.fire({\n        title: \"Remove item from shopping cart?\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#5cb85c\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"Yes, delete it!\",\n      }).then((result) => {\n        if (result.isConfirmed) {\n          if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n            axios\n              .delete(`${SERVER_HOST}/cart/${this.state.cartId}}`)\n              .then((res) => {\n                window.location.reload(false);\n              });\n          } else {\n            let index = 0;\n            let curCart = JSON.parse(localStorage.cart);\n            curCart.forEach((item, i) => {\n              if (item.productId === this.props.item.productId) {\n                index = i;\n              }\n            });\n            curCart.splice(index, 1);\n            localStorage.cart = JSON.stringify(curCart);\n            window.location.reload(false);\n          }\n        }\n      });\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"product border-bottom mt-0 mb-2\">\n        <div className=\"row\">\n          <div className=\"col-md-3\">\n            <Carousel nextLabel=\"\" prevLabel=\"\" indicators={false}>\n              {this.state.photos.map((photo) => (\n                <Carousel.Item key={photo._id}>\n                  <img className=\"rounded\" key={photo._id} id={photo._id} />\n                </Carousel.Item>\n              ))}\n            </Carousel>\n          </div>\n          <div className=\"col-md-8\">\n            <div className=\"info\">\n              <div className=\"row\">\n                <div className=\"col-md-5\">\n                  <div>\n                    <h6>{this.state.productName}</h6>\n                  </div>\n                </div>\n                <div className=\"col-md-4 quantity\">\n                  <label>Quantity:</label>\n                  <br />\n                  <button\n                    className=\"btn rounded-circle mr-3\"\n                    onClick={this.handleDecreaseQuantity}\n                  >\n                    -\n                  </button>\n                  {this.state.quantity}\n\n                  <span className=\"\">\n                    <button\n                      className=\"btn rounded-circle ml-3\"\n                      onClick={this.handleIncreaseQuantity}\n                    >\n                      +\n                    </button>\n                  </span>\n                </div>\n                <div className=\"col-md-3 price\">\n                  <span>\n                    €\n                    {(Math.round(this.state.totalPrice * 100) / 100).toFixed(2)}\n                  </span>\n                  <Trash\n                    onClick={this.handleRemoveItem}\n                    className=\"ml-3 cursor-pointer\"\n                    color=\"#787878\"\n                    size={20}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default CartRow;\n"]},"metadata":{},"sourceType":"module"}