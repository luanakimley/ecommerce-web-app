{"ast":null,"code":"import _toConsumableArray from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _defineProperty from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _classCallCheck from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import{Link,Redirect,withRouter}from\"react-router-dom\";import{Form,Button,InputGroup}from\"react-bootstrap\";import Swal from\"sweetalert2\";import{XLg}from\"react-bootstrap-icons\";import axios from\"axios\";import{SERVER_HOST,CATEGORIES,COLOURS}from\"../../config/global_constants.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EditProduct=/*#__PURE__*/function(_React$Component){_inherits(EditProduct,_React$Component);var _super=_createSuper(EditProduct);function EditProduct(props){var _this;_classCallCheck(this,EditProduct);_this=_super.call(this,props);_this.handleChange=function(e){_this.setState(_defineProperty({},e.target.name,e.target.value));};_this.handleFileChange=function(e){_this.setState({selectedFiles:e.target.files});};_this.addCategory=function(e){if(_this.state.selectedCategory!==\"\"&&!_this.state.categories.includes(_this.state.selectedCategory)){_this.setState({categories:[].concat(_toConsumableArray(_this.state.categories),[_this.state.selectedCategory])});}};_this.removeCategory=function(e){_this.setState({categories:_this.state.categories.filter(function(g){return g!==e.currentTarget.dataset.id;})});};_this.addColour=function(e){if(_this.state.selectedColours!==\"\"&&!_this.state.colours.includes(_this.state.selectedColours)){_this.setState({colours:[].concat(_toConsumableArray(_this.state.colours),[_this.state.selectedColours])});}};_this.removeColour=function(e){_this.setState({colours:_this.state.colours.filter(function(g){return g!==e.currentTarget.dataset.id;})});};_this.handleRemovePhoto=function(e){var formData=new FormData();formData.append(\"productName\",_this.state.productName);formData.append(\"price\",_this.state.price);formData.append(\"description\",_this.state.description);for(var i=0;i<_this.state.categories.length;i++){formData.append(\"categories\",_this.state.categories[i]);}formData.append(\"stock\",_this.state.stock);for(var _i=0;_i<_this.state.colours.length;_i++){formData.append(\"colours\",_this.state.colours[_i]);}if(_this.state.selectedFiles!==null){for(var _i2=0;_i2<_this.state.selectedFiles.length;_i2++){formData.append(\"productPhotos\",_this.state.selectedFiles[_i2]);}}else{for(var _i3=0;_i3<_this.state.photos.length;_i3++){formData.append(\"productPhotos\",JSON.stringify(_this.state.photos[_i3]));}}axios.put(\"\".concat(SERVER_HOST,\"/products/photo/\").concat(_this.state._id,\"/\").concat(e.currentTarget.dataset.id),formData,{headers:{authorization:localStorage.token}});};_this.handleSubmit=function(e){e.preventDefault();axios.defaults.withCredentials=true;var formData=new FormData();formData.append(\"productName\",_this.state.productName);formData.append(\"price\",_this.state.price);formData.append(\"description\",_this.state.description);for(var i=0;i<_this.state.categories.length;i++){formData.append(\"categories\",_this.state.categories[i]);}formData.append(\"stock\",_this.state.stock);for(var _i4=0;_i4<_this.state.colours.length;_i4++){formData.append(\"colours\",_this.state.colours[_i4]);}if(_this.state.selectedFiles&&!_this.state.photos.length){for(var _i5=0;_i5<_this.state.selectedFiles.length;_i5++){formData.append(\"newProductPhotos\",_this.state.selectedFiles[_i5]);}}else if(!_this.state.selectedFiles&&_this.state.photos.length){for(var _i6=0;_i6<_this.state.photos.length;_i6++){formData.append(\"productPhotos\",JSON.stringify(_this.state.photos[_i6]));}}else{for(var _i7=0;_i7<_this.state.selectedFiles.length;_i7++){formData.append(\"newProductPhotos\",_this.state.selectedFiles[_i7]);}for(var _i8=0;_i8<_this.state.photos.length;_i8++){formData.append(\"productPhotos\",JSON.stringify(_this.state.photos[_i8]));}}axios.put(\"\".concat(SERVER_HOST,\"/products/\").concat(_this.props.match.params.id),formData,{headers:{authorization:localStorage.token}}).then(function(res){if(res.data){if(res.data.errorMessage){console.log(res.data.errorMessage);Swal.fire({title:\"Product not updated\",text:res.data.errorMessage,icon:\"error\",confirmButtonColor:\"#123c69\",showConfirmButton:true});}else{console.log(\"Product updated\");Swal.fire({title:\"Product updated\",text:\"The product details have been updated.\",icon:\"success\",showConfirmButton:false,timer:1500});_this.setState({redirectToHome:true});}}else{console.log(\"Product not updated\");Swal.fire({title:\"Product not updated\",text:\"Make sure that data is valid.\",icon:\"error\",confirmButtonColor:\"#123c69\",showConfirmButton:true});}});};_this.state={productName:\"\",price:\"\",_id:\"\",description:\"\",categories:[],selectedCategory:\"\",stock:0,colours:[],photos:[],selectedColours:\"\",selectedFiles:null,redirectToHome:false};return _this;}_createClass(EditProduct,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axios.defaults.withCredentials=true;axios.get(\"\".concat(SERVER_HOST,\"/products/\").concat(this.props.match.params.id),{headers:{authorization:localStorage.token}}).then(function(res){if(res.data){if(res.data.errorMessage){console.log(res.data.errorMessage);}else{_this2.setState({_id:res.data._id,productName:res.data.productName,price:res.data.price,description:res.data.description,categories:res.data.categories,stock:res.data.stock,colours:res.data.colours,photos:res.data.photos});res.data.photos.map(function(photo){return axios.get(\"\".concat(SERVER_HOST,\"/products/photo/\").concat(photo.filename)).then(function(res){if(res.data){if(res.data.errorMessage){console.log(res.data.errorMessage);}else{document.getElementById(photo._id).src=\"data:;base64,\".concat(res.data.image);}}else{console.log(\"Record not found\");}});});}}else{console.log(\"Product not found\");}});}},{key:\"validateProductName\",value:function validateProductName(){return this.state.productName!==\"\";}},{key:\"validatePrice\",value:function validatePrice(){return this.state.price>0;}},{key:\"validateDescription\",value:function validateDescription(){return this.state.description!==\"\";}},{key:\"validateCategories\",value:function validateCategories(){return this.state.categories.length!==0&&this.state.categories!==undefined;}},{key:\"validateStock\",value:function validateStock(){return this.state.stock>=0;}},{key:\"validateColours\",value:function validateColours(){return this.state.colours.length!==0&&this.state.colours!==undefined;}},{key:\"validatePhotos\",value:function validatePhotos(){if(this.state.selectedFiles){return this.state.selectedFiles.length+this.state.photos.length>=2;}else{return this.state.photos.length>=2;}}},{key:\"validate\",value:function validate(){return{productName:this.validateProductName(),price:this.validatePrice(),description:this.validateDescription(),categories:this.validateCategories(),stock:this.validateStock(),colours:this.validateColours(),photos:this.validatePhotos()};}},{key:\"render\",value:function render(){var _this3=this;var formInputsState=this.validate();var inputsAreAllValid=Object.keys(formInputsState).every(function(index){return formInputsState[index];});var productNameError=\"\";var priceError=\"\";var descriptionError=\"\";var categoriesError=\"\";var stockError=\"\";var coloursError=\"\";var photosError=\"\";if(!this.validateProductName()){productNameError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Product name is required.\"});}if(!this.validateDescription()){descriptionError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Product description is required.\"});}if(!this.validatePrice()){priceError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Price must be a positive number.\"});}if(!this.validateCategories()){categoriesError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Choose at least 1 category.\"});}if(!this.validateStock()){stockError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Stock must be a positive number.\"});}if(!this.validateColours()){coloursError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Choose at least 1 colour.\"});}if(!this.validatePhotos()){photosError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Choose at least 2 photos.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container p-3\",children:[this.state.redirectToHome?/*#__PURE__*/_jsx(Redirect,{to:\"/\"}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"card flex-column border-0 shadow rounded-3 overflow-hidden p-4 m-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\" text-center mt-3  \",children:\"Edit Product\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-container m-4\",children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"productName\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"productName\",value:this.state.productName,onChange:this.handleChange}),productNameError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"price\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"price\",value:this.state.price,onChange:this.handleChange}),priceError]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"description\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Description\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"description\",as:\"textarea\",value:this.state.description,onChange:this.handleChange}),descriptionError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"categories\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Categories\"}),/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsxs(Form.Control,{name:\"selectedCategory\",as:\"select\",onChange:this.handleChange,defaultValue:\"DEFAULT\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"DEFAULT\",disabled:true,children:\"Select category...\"}),CATEGORIES.filter(function(g){return!_this3.state.categories.includes(g);}).map(function(g){return/*#__PURE__*/_jsx(\"option\",{value:g,children:g.toUpperCase()},g);})]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:this.addCategory,children:\"Add Category\"})]}),this.state.categories.map(function(g){return/*#__PURE__*/_jsxs(\"span\",{className:\"badge badge-secondary p-1 mt-2 mr-2\",children:[g.toUpperCase(),/*#__PURE__*/_jsx(XLg,{\"data-id\":g,className:\"ml-1\",onClick:_this3.removeCategory})]},g);}),categoriesError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"stock\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Stock\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"stock\",value:this.state.stock,onChange:this.handleChange}),stockError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"colours\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Colours\"}),/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsxs(Form.Control,{name:\"selectedColours\",as:\"select\",onChange:this.handleChange,defaultValue:\"DEFAULT\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"DEFAULT\",disabled:true,children:\"Select colour...\"}),Object.keys(COLOURS).filter(function(g){return!_this3.state.colours.includes(g);}).map(function(g){return/*#__PURE__*/_jsx(\"option\",{value:g,children:g.toUpperCase()},g);})]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:this.addColour,children:\"Add Colour\"})]}),this.state.colours.map(function(g){return/*#__PURE__*/_jsxs(\"span\",{className:\"badge badge-secondary p-1 mt-2 mr-2\",children:[g.toUpperCase(),/*#__PURE__*/_jsx(XLg,{\"data-id\":g,className:\"ml-1\",onClick:_this3.removeColour})]},g);}),coloursError]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"photos\",className:\"mt-2\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Photos\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"file\",multiple:true,onChange:this.handleFileChange,accept:\"image/png, image/jpg, image/jpeg\"}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex\",children:this.state.photos.map(function(photo){return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"rounded mt-3  mr-3 ml-0\",id:photo._id,width:\"200px\",alt:\"Product\"},photo._id),/*#__PURE__*/_jsx(\"button\",{\"data-id\":photo.filename,className:\"btn btn-secondary mr-3 mt-2\",onClick:_this3.handleRemovePhoto,children:\"Remove image\"})]});})}),photosError]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success mt-3 mr-2\",onClick:this.handleSubmit,disabled:!inputsAreAllValid,children:\"Edit\"}),/*#__PURE__*/_jsx(Link,{to:\"/shop\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger mt-3 ml-2\",children:\"Cancel\"})})]})})]})]});}}]);return EditProduct;}(React.Component);export default withRouter(EditProduct);","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ProductForms/EditProduct.jsx"],"names":["React","Link","Redirect","withRouter","Form","Button","InputGroup","Swal","XLg","axios","SERVER_HOST","CATEGORIES","COLOURS","EditProduct","props","handleChange","e","setState","target","name","value","handleFileChange","selectedFiles","files","addCategory","state","selectedCategory","categories","includes","removeCategory","filter","g","currentTarget","dataset","id","addColour","selectedColours","colours","removeColour","handleRemovePhoto","formData","FormData","append","productName","price","description","i","length","stock","photos","JSON","stringify","put","_id","headers","authorization","localStorage","token","handleSubmit","preventDefault","defaults","withCredentials","match","params","then","res","data","errorMessage","console","log","fire","title","text","icon","confirmButtonColor","showConfirmButton","timer","redirectToHome","get","map","photo","filename","document","getElementById","src","image","undefined","validateProductName","validatePrice","validateDescription","validateCategories","validateStock","validateColours","validatePhotos","formInputsState","validate","inputsAreAllValid","Object","keys","every","index","productNameError","priceError","descriptionError","categoriesError","stockError","coloursError","photosError","toUpperCase","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link, Redirect, withRouter } from \"react-router-dom\";\nimport { Form, Button, InputGroup } from \"react-bootstrap\";\nimport Swal from \"sweetalert2\";\nimport { XLg } from \"react-bootstrap-icons\";\nimport axios from \"axios\";\nimport {\n  SERVER_HOST,\n  CATEGORIES,\n  COLOURS,\n} from \"../../config/global_constants.js\";\n\nclass EditProduct extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      productName: \"\",\n      price: \"\",\n      _id: \"\",\n      description: \"\",\n      categories: [],\n      selectedCategory: \"\",\n      stock: 0,\n      colours: [],\n      photos: [],\n      selectedColours: \"\",\n      selectedFiles: null,\n      redirectToHome: false,\n    };\n  }\n\n  componentDidMount() {\n    axios.defaults.withCredentials = true;\n\n    axios\n      .get(`${SERVER_HOST}/products/${this.props.match.params.id}`, {\n        headers: { authorization: localStorage.token },\n      })\n      .then((res) => {\n        if (res.data) {\n          if (res.data.errorMessage) {\n            console.log(res.data.errorMessage);\n          } else {\n            this.setState({\n              _id: res.data._id,\n              productName: res.data.productName,\n              price: res.data.price,\n              description: res.data.description,\n              categories: res.data.categories,\n              stock: res.data.stock,\n              colours: res.data.colours,\n              photos: res.data.photos,\n            });\n\n            res.data.photos.map((photo) => {\n              return axios\n                .get(`${SERVER_HOST}/products/photo/${photo.filename}`)\n                .then((res) => {\n                  if (res.data) {\n                    if (res.data.errorMessage) {\n                      console.log(res.data.errorMessage);\n                    } else {\n                      document.getElementById(\n                        photo._id\n                      ).src = `data:;base64,${res.data.image}`;\n                    }\n                  } else {\n                    console.log(\"Record not found\");\n                  }\n                });\n            });\n          }\n        } else {\n          console.log(`Product not found`);\n        }\n      });\n  }\n\n  handleChange = (e) => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n\n  handleFileChange = (e) => {\n    this.setState({ selectedFiles: e.target.files });\n  };\n\n  addCategory = (e) => {\n    if (\n      this.state.selectedCategory !== \"\" &&\n      !this.state.categories.includes(this.state.selectedCategory)\n    ) {\n      this.setState({\n        categories: [...this.state.categories, this.state.selectedCategory],\n      });\n    }\n  };\n\n  removeCategory = (e) => {\n    this.setState({\n      categories: this.state.categories.filter(\n        (g) => g !== e.currentTarget.dataset.id\n      ),\n    });\n  };\n\n  addColour = (e) => {\n    if (\n      this.state.selectedColours !== \"\" &&\n      !this.state.colours.includes(this.state.selectedColours)\n    ) {\n      this.setState({\n        colours: [...this.state.colours, this.state.selectedColours],\n      });\n    }\n  };\n\n  removeColour = (e) => {\n    this.setState({\n      colours: this.state.colours.filter(\n        (g) => g !== e.currentTarget.dataset.id\n      ),\n    });\n  };\n\n  handleRemovePhoto = (e) => {\n    let formData = new FormData();\n\n    formData.append(\"productName\", this.state.productName);\n    formData.append(\"price\", this.state.price);\n    formData.append(\"description\", this.state.description);\n    for (let i = 0; i < this.state.categories.length; i++) {\n      formData.append(\"categories\", this.state.categories[i]);\n    }\n    formData.append(\"stock\", this.state.stock);\n    for (let i = 0; i < this.state.colours.length; i++) {\n      formData.append(\"colours\", this.state.colours[i]);\n    }\n    if (this.state.selectedFiles !== null) {\n      for (let i = 0; i < this.state.selectedFiles.length; i++) {\n        formData.append(\"productPhotos\", this.state.selectedFiles[i]);\n      }\n    } else {\n      for (let i = 0; i < this.state.photos.length; i++) {\n        formData.append(\"productPhotos\", JSON.stringify(this.state.photos[i]));\n      }\n    }\n\n    axios.put(\n      `${SERVER_HOST}/products/photo/${this.state._id}/${e.currentTarget.dataset.id}`,\n      formData,\n      {\n        headers: { authorization: localStorage.token },\n      }\n    );\n  };\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n\n    axios.defaults.withCredentials = true;\n\n    let formData = new FormData();\n\n    formData.append(\"productName\", this.state.productName);\n    formData.append(\"price\", this.state.price);\n    formData.append(\"description\", this.state.description);\n    for (let i = 0; i < this.state.categories.length; i++) {\n      formData.append(\"categories\", this.state.categories[i]);\n    }\n    formData.append(\"stock\", this.state.stock);\n    for (let i = 0; i < this.state.colours.length; i++) {\n      formData.append(\"colours\", this.state.colours[i]);\n    }\n\n    if (this.state.selectedFiles && !this.state.photos.length) {\n      for (let i = 0; i < this.state.selectedFiles.length; i++) {\n        formData.append(\"newProductPhotos\", this.state.selectedFiles[i]);\n      }\n    } else if (!this.state.selectedFiles && this.state.photos.length) {\n      for (let i = 0; i < this.state.photos.length; i++) {\n        formData.append(\"productPhotos\", JSON.stringify(this.state.photos[i]));\n      }\n    } else {\n      for (let i = 0; i < this.state.selectedFiles.length; i++) {\n        formData.append(\"newProductPhotos\", this.state.selectedFiles[i]);\n      }\n      for (let i = 0; i < this.state.photos.length; i++) {\n        formData.append(\"productPhotos\", JSON.stringify(this.state.photos[i]));\n      }\n    }\n\n    axios\n      .put(`${SERVER_HOST}/products/${this.props.match.params.id}`, formData, {\n        headers: { authorization: localStorage.token },\n      })\n      .then((res) => {\n        if (res.data) {\n          if (res.data.errorMessage) {\n            console.log(res.data.errorMessage);\n            Swal.fire({\n              title: \"Product not updated\",\n              text: res.data.errorMessage,\n              icon: \"error\",\n              confirmButtonColor: \"#123c69\",\n              showConfirmButton: true,\n            });\n          } else {\n            console.log(\"Product updated\");\n            Swal.fire({\n              title: \"Product updated\",\n              text: \"The product details have been updated.\",\n              icon: \"success\",\n              showConfirmButton: false,\n              timer: 1500,\n            });\n            this.setState({ redirectToHome: true });\n          }\n        } else {\n          console.log(\"Product not updated\");\n          Swal.fire({\n            title: \"Product not updated\",\n            text: \"Make sure that data is valid.\",\n            icon: \"error\",\n            confirmButtonColor: \"#123c69\",\n            showConfirmButton: true,\n          });\n        }\n      });\n  };\n\n  validateProductName() {\n    return this.state.productName !== \"\";\n  }\n\n  validatePrice() {\n    return this.state.price > 0;\n  }\n\n  validateDescription() {\n    return this.state.description !== \"\";\n  }\n\n  validateCategories() {\n    return (\n      this.state.categories.length !== 0 && this.state.categories !== undefined\n    );\n  }\n\n  validateStock() {\n    return this.state.stock >= 0;\n  }\n\n  validateColours() {\n    return this.state.colours.length !== 0 && this.state.colours !== undefined;\n  }\n\n  validatePhotos() {\n    if (this.state.selectedFiles) {\n      return this.state.selectedFiles.length + this.state.photos.length >= 2;\n    } else {\n      return this.state.photos.length >= 2;\n    }\n  }\n\n  validate() {\n    return {\n      productName: this.validateProductName(),\n      price: this.validatePrice(),\n      description: this.validateDescription(),\n      categories: this.validateCategories(),\n      stock: this.validateStock(),\n      colours: this.validateColours(),\n      photos: this.validatePhotos(),\n    };\n  }\n\n  render() {\n    const formInputsState = this.validate();\n    const inputsAreAllValid = Object.keys(formInputsState).every(\n      (index) => formInputsState[index]\n    );\n\n    let productNameError = \"\";\n    let priceError = \"\";\n    let descriptionError = \"\";\n    let categoriesError = \"\";\n    let stockError = \"\";\n    let coloursError = \"\";\n    let photosError = \"\";\n\n    if (!this.validateProductName()) {\n      productNameError = (\n        <p className=\"text-danger mt-2\">Product name is required.</p>\n      );\n    }\n    if (!this.validateDescription()) {\n      descriptionError = (\n        <p className=\"text-danger mt-2\">Product description is required.</p>\n      );\n    }\n    if (!this.validatePrice()) {\n      priceError = (\n        <p className=\"text-danger mt-2\">Price must be a positive number.</p>\n      );\n    }\n    if (!this.validateCategories()) {\n      categoriesError = (\n        <p className=\"text-danger mt-2\">Choose at least 1 category.</p>\n      );\n    }\n    if (!this.validateStock()) {\n      stockError = (\n        <p className=\"text-danger mt-2\">Stock must be a positive number.</p>\n      );\n    }\n    if (!this.validateColours()) {\n      coloursError = (\n        <p className=\"text-danger mt-2\">Choose at least 1 colour.</p>\n      );\n    }\n    if (!this.validatePhotos()) {\n      photosError = (\n        <p className=\"text-danger mt-2\">Choose at least 2 photos.</p>\n      );\n    }\n\n    return (\n      <div className=\"container p-3\">\n        {this.state.redirectToHome ? <Redirect to=\"/\" /> : null}\n\n        <div className=\"card flex-column border-0 shadow rounded-3 overflow-hidden p-4 m-4\">\n          <h2 className=\" text-center mt-3  \">Edit Product</h2>\n          <div className=\"form-container m-4\">\n            <Form>\n              <Form.Group className=\"mt-2\" controlId=\"productName\">\n                <Form.Label>Product Name</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"productName\"\n                  value={this.state.productName}\n                  onChange={this.handleChange}\n                />\n                {productNameError}\n              </Form.Group>\n\n              <Form.Group className=\"mt-2\" controlId=\"price\">\n                <Form.Label>Price</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"price\"\n                  value={this.state.price}\n                  onChange={this.handleChange}\n                />\n                {priceError}\n              </Form.Group>\n\n              <Form.Group controlId=\"description\">\n                <Form.Label>Description</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"description\"\n                  as=\"textarea\"\n                  value={this.state.description}\n                  onChange={this.handleChange}\n                />\n                {descriptionError}\n              </Form.Group>\n\n              <Form.Group className=\"mt-2\" controlId=\"categories\">\n                <Form.Label>Categories</Form.Label>\n                <InputGroup>\n                  <Form.Control\n                    name=\"selectedCategory\"\n                    as=\"select\"\n                    onChange={this.handleChange}\n                    defaultValue={\"DEFAULT\"}\n                  >\n                    <option value=\"DEFAULT\" disabled>\n                      Select category...\n                    </option>\n                    {CATEGORIES.filter(\n                      (g) => !this.state.categories.includes(g)\n                    ).map((g) => (\n                      <option key={g} value={g}>\n                        {g.toUpperCase()}\n                      </option>\n                    ))}\n                  </Form.Control>\n\n                  <Button\n                    variant=\"outline-secondary\"\n                    onClick={this.addCategory}\n                  >\n                    Add Category\n                  </Button>\n                </InputGroup>\n                {this.state.categories.map((g) => (\n                  <span className=\"badge badge-secondary p-1 mt-2 mr-2\" key={g}>\n                    {g.toUpperCase()}\n                    <XLg\n                      data-id={g}\n                      className=\"ml-1\"\n                      onClick={this.removeCategory}\n                    />\n                  </span>\n                ))}\n                {categoriesError}\n              </Form.Group>\n\n              <Form.Group className=\"mt-2\" controlId=\"stock\">\n                <Form.Label>Stock</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"stock\"\n                  value={this.state.stock}\n                  onChange={this.handleChange}\n                />\n                {stockError}\n              </Form.Group>\n\n              <Form.Group className=\"mt-2\" controlId=\"colours\">\n                <Form.Label>Colours</Form.Label>\n                <InputGroup>\n                  <Form.Control\n                    name=\"selectedColours\"\n                    as=\"select\"\n                    onChange={this.handleChange}\n                    defaultValue={\"DEFAULT\"}\n                  >\n                    <option value=\"DEFAULT\" disabled>\n                      Select colour...\n                    </option>\n                    {Object.keys(COLOURS)\n                      .filter((g) => !this.state.colours.includes(g))\n                      .map((g) => (\n                        <option key={g} value={g}>\n                          {g.toUpperCase()}\n                        </option>\n                      ))}\n                  </Form.Control>\n\n                  <Button variant=\"outline-secondary\" onClick={this.addColour}>\n                    Add Colour\n                  </Button>\n                </InputGroup>\n                {this.state.colours.map((g) => (\n                  <span className=\"badge badge-secondary p-1 mt-2 mr-2\" key={g}>\n                    {g.toUpperCase()}\n                    <XLg\n                      data-id={g}\n                      className=\"ml-1\"\n                      onClick={this.removeColour}\n                    />\n                  </span>\n                ))}\n                {coloursError}\n              </Form.Group>\n              <Form.Group controlId=\"photos\" className=\"mt-2\">\n                <Form.Label>Photos</Form.Label>\n                <Form.Control\n                  type=\"file\"\n                  multiple\n                  onChange={this.handleFileChange}\n                  accept=\"image/png, image/jpg, image/jpeg\"\n                />\n                <div className=\"d-flex\">\n                  {this.state.photos.map((photo) => (\n                    <div className=\"d-flex flex-column\">\n                      <img\n                        className=\"rounded mt-3  mr-3 ml-0\"\n                        key={photo._id}\n                        id={photo._id}\n                        width=\"200px\"\n                        alt=\"Product\"\n                      />\n                      <button\n                        data-id={photo.filename}\n                        className=\"btn btn-secondary mr-3 mt-2\"\n                        onClick={this.handleRemovePhoto}\n                      >\n                        Remove image\n                      </button>\n                    </div>\n                  ))}\n                </div>\n                {photosError}\n              </Form.Group>\n\n              <br />\n\n              <button\n                className=\"btn btn-success mt-3 mr-2\"\n                onClick={this.handleSubmit}\n                disabled={!inputsAreAllValid}\n              >\n                Edit\n              </button>\n\n              <Link to={\"/shop\"}>\n                <button className=\"btn btn-danger mt-3 ml-2\">Cancel</button>\n              </Link>\n            </Form>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(EditProduct);\n"]},"metadata":{},"sourceType":"module"}