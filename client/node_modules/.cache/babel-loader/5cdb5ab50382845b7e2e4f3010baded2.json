{"ast":null,"code":"import _toConsumableArray from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from\"react\";import ShopGrid from\"../components/ProductArea/ShopGrid\";import ShopBanner from\"../components/ShopBanner\";import SideBar from\"../components/ShopSideBar/SideBar\";import axios from\"axios\";import{SERVER_HOST}from\"../config/global_constants.js\";import{Spinner}from\"react-bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Shop=/*#__PURE__*/function(_Component){_inherits(Shop,_Component);var _super=_createSuper(Shop);function Shop(props){var _this;_classCallCheck(this,Shop);_this=_super.call(this,props);_this.getAllItems=function(e){var url=\"\".concat(SERVER_HOST,\"/products?\");if(_this.state.sort===\"nameAsc\"){url+=\"&sortBy=productName&orderBy=1\";}else if(_this.state.sort===\"nameDesc\"){url+=\"&sortBy=productName&orderBy=-1\";}else if(_this.state.sort===\"priceAsc\"){url+=\"&sortBy=price&orderBy=1\";}else if(_this.state.sort===\"priceDesc\"){url+=\"&sortBy=price&orderBy=-1\";}else if(_this.state.sort===\"stockAsc\"){url+=\"&sortBy=stock&orderBy=1\";}else if(_this.state.sort===\"stockDesc\"){url+=\"&sortBy=stock&orderBy=-1\";}axios.get(url).then(function(res){console.log(\"Products read\");_this.setState({products:res.data});_this.setState({category:\"all items\"});var maxPrice=Math.max.apply(Math,_this.state.products.map(function(p){return p.price;}));var minPrice=Math.min.apply(Math,_this.state.products.map(function(p){return p.price;}));_this.setState({minPrice:minPrice});_this.setState({maxPrice:maxPrice});_this.setState({value:[minPrice,maxPrice]});var productCategories=_this.state.products.map(function(product){return product.categories;});_this.setState({uniqueCategories:_toConsumableArray(new Set(productCategories.flat(1))).sort()});var productColours=_this.state.products.map(function(product){return product.colours;});_this.setState({uniqueColours:_toConsumableArray(new Set(productColours.flat(1))).sort()});_this.setState({loading:false});}).catch(function(err){console.log(err.response.data);});};_this.handleCategoryFilter=function(e){var url=\"\".concat(SERVER_HOST,\"/products?categories=\").concat(e.target.textContent.toLowerCase());_this.setState({category:e.target.textContent});if(_this.state.sort===\"nameAsc\"){url+=\"&sortBy=productName&orderBy=1\";}else if(_this.state.sort===\"nameDesc\"){url+=\"&sortBy=productName&orderBy=-1\";}else if(_this.state.sort===\"priceAsc\"){url+=\"&sortBy=price&orderBy=1\";}else if(_this.state.sort===\"priceDesc\"){url+=\"&sortBy=price&orderBy=-1\";}else if(_this.state.sort===\"stockAsc\"){url+=\"&sortBy=stock&orderBy=1\";}else if(_this.state.sort===\"stockDesc\"){url+=\"&sortBy=stock&orderBy=-1\";}_this.fetchItems(url);};_this.handlePriceFilter=function(e,newVal){_this.setState({value:newVal});var url=\"\".concat(SERVER_HOST,\"/products?\");if(_this.state.category!==\"all items\"){url+=\"categories=\".concat(_this.state.category.toLowerCase(),\"&minprice=\").concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}else{url+=\"&minprice=\".concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}if(_this.state.sort===\"nameAsc\"){url+=\"&sortBy=productName&orderBy=1\";}else if(_this.state.sort===\"nameDesc\"){url+=\"&sortBy=productName&orderBy=-1\";}else if(_this.state.sort===\"priceAsc\"){url+=\"&sortBy=price&orderBy=1\";}else if(_this.state.sort===\"priceDesc\"){url+=\"&sortBy=price&orderBy=-1\";}else if(_this.state.sort===\"stockAsc\"){url+=\"&sortBy=stock&orderBy=1\";}else if(_this.state.sort===\"stockDesc\"){url+=\"&sortBy=stock&orderBy=-1\";}_this.fetchItems(url);};_this.handleColoursFilter=function(e){if(!_this.state.colours.includes(e.target.textContent)){_this.state.colours.push(e.target.textContent);}else{var index=_this.state.colours.indexOf(e.target.textContent);_this.state.colours.splice(index,1);}var url=\"\".concat(SERVER_HOST,\"/products?\");if(_this.state.category!==\"all items\"){url+=\"categories=\".concat(_this.state.category.toLowerCase(),\"&minprice=\").concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}else{url+=\"&minprice=\".concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}if(_this.state.sort===\"nameAsc\"){url+=\"&sortBy=productName&orderBy=1\";}else if(_this.state.sort===\"nameDesc\"){url+=\"&sortBy=productName&orderBy=-1\";}else if(_this.state.sort===\"priceAsc\"){url+=\"&sortBy=price&orderBy=1\";}else if(_this.state.sort===\"priceDesc\"){url+=\"&sortBy=price&orderBy=-1\";}else if(_this.state.sort===\"stockAsc\"){url+=\"&sortBy=stock&orderBy=1\";}else if(_this.state.sort===\"stockDesc\"){url+=\"&sortBy=stock&orderBy=-1\";}_this.fetchItems(url);};_this.handleSearch=function(e){_this.setState({searchQuery:e.target.value});var url=\"\".concat(SERVER_HOST,\"/products?\");if(_this.state.category!==\"all items\"){url+=\"categories=\".concat(_this.state.category.toLowerCase(),\"&q=\").concat(e.target.value,\"&minprice=\").concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}else{url+=\"q=\".concat(e.target.value,\"&minprice=\").concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}if(_this.state.sort===\"nameAsc\"){url+=\"&sortBy=productName&orderBy=1\";}else if(_this.state.sort===\"nameDesc\"){url+=\"&sortBy=productName&orderBy=-1\";}else if(_this.state.sort===\"priceAsc\"){url+=\"&sortBy=price&orderBy=1\";}else if(_this.state.sort===\"priceDesc\"){url+=\"&sortBy=price&orderBy=-1\";}else if(_this.state.sort===\"stockAsc\"){url+=\"&sortBy=stock&orderBy=1\";}else if(_this.state.sort===\"stockDesc\"){url+=\"&sortBy=stock&orderBy=-1\";}_this.fetchItems(url);};_this.handleSort=function(e){var url=\"\".concat(SERVER_HOST,\"/products?\");if(_this.state.category!==\"all items\"){url+=\"categories=\".concat(_this.state.category.toLowerCase(),\"&productName=\").concat(_this.state.searchQuery,\"&minprice=\").concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}else{url+=\"productName=\".concat(_this.state.searchQuery,\"&minprice=\").concat(_this.state.value[0],\"&maxprice=\").concat(_this.state.value[1]);_this.state.colours.forEach(function(colour){url+=\"&colours=\".concat(colour);});}if(e.target.value===\"nameAsc\"){url+=\"&sortBy=productName&orderBy=1\";_this.setState({sort:e.target.value});}else if(e.target.value===\"nameDesc\"){url+=\"&sortBy=productName&orderBy=-1\";_this.setState({sort:e.target.value});}else if(e.target.value===\"priceAsc\"){url+=\"&sortBy=price&orderBy=1\";_this.setState({sort:e.target.value});}else if(e.target.value===\"priceDesc\"){url+=\"&sortBy=price&orderBy=-1\";_this.setState({sort:e.target.value});}else if(e.target.value===\"stockAsc\"){url+=\"&sortBy=stock&orderBy=1\";_this.setState({sort:e.target.value});}else if(e.target.value===\"stockDesc\"){url+=\"&sortBy=stock&orderBy=-1\";_this.setState({sort:e.target.value});}else{_this.setState({sort:\"\"});}_this.fetchItems(url);};_this.state={products:[],category:\"all items\",value:[],minPrice:1,maxPrice:100,uniqueCategories:[],colours:[],uniqueColours:[],searchQuery:\"\",sort:\"\",loading:true};return _this;}_createClass(Shop,[{key:\"componentDidMount\",value:function componentDidMount(){this.getAllItems();}},{key:\"fetchItems\",value:function fetchItems(url){var _this2=this;axios.get(url).then(function(res){console.log(\"Records read\");_this2.setState({products:res.data});}).catch(function(err){console.log(err.response.data);});}},{key:\"render\",value:function render(){return this.state.loading?/*#__PURE__*/_jsx(Spinner,{animation:\"border\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\"})}):/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(ShopBanner,{title:this.state.category}),/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(SideBar,{onFilter:this.handleCategoryFilter,getAllItems:this.getAllItems,onPriceFilter:this.handlePriceFilter,value:this.state.value,minPrice:this.state.minPrice,maxPrice:this.state.maxPrice,curMinPrice:this.state.value[0],curMaxPrice:this.state.value[1],uniqueCategories:this.state.uniqueCategories,onColourFilter:this.handleColoursFilter,uniqueColours:this.state.uniqueColours,colours:this.state.colours,onSearch:this.handleSearch,curCategory:this.state.category}),/*#__PURE__*/_jsx(ShopGrid,{products:this.state.products,onSort:this.handleSort})]})})})]});}}]);return Shop;}(Component);export default Shop;","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/pages/Shop.jsx"],"names":["React","Component","ShopGrid","ShopBanner","SideBar","axios","SERVER_HOST","Spinner","Shop","props","getAllItems","e","url","state","sort","get","then","res","console","log","setState","products","data","category","maxPrice","Math","max","apply","map","p","price","minPrice","min","value","productCategories","product","categories","uniqueCategories","Set","flat","productColours","colours","uniqueColours","loading","catch","err","response","handleCategoryFilter","target","textContent","toLowerCase","fetchItems","handlePriceFilter","newVal","forEach","colour","handleColoursFilter","includes","push","index","indexOf","splice","handleSearch","searchQuery","handleSort"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport ShopGrid from \"../components/ProductArea/ShopGrid\";\nimport ShopBanner from \"../components/ShopBanner\";\nimport SideBar from \"../components/ShopSideBar/SideBar\";\nimport axios from \"axios\";\nimport { SERVER_HOST } from \"../config/global_constants.js\";\nimport { Spinner } from \"react-bootstrap\";\n\nclass Shop extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      products: [],\n      category: \"all items\",\n      value: [],\n      minPrice: 1,\n      maxPrice: 100,\n      uniqueCategories: [],\n      colours: [],\n      uniqueColours: [],\n      searchQuery: \"\",\n      sort: \"\",\n      loading: true,\n    };\n  }\n\n  componentDidMount() {\n    this.getAllItems();\n  }\n\n  getAllItems = (e) => {\n    let url = `${SERVER_HOST}/products?`;\n\n    if (this.state.sort === \"nameAsc\") {\n      url += `&sortBy=productName&orderBy=1`;\n    } else if (this.state.sort === \"nameDesc\") {\n      url += `&sortBy=productName&orderBy=-1`;\n    } else if (this.state.sort === \"priceAsc\") {\n      url += `&sortBy=price&orderBy=1`;\n    } else if (this.state.sort === \"priceDesc\") {\n      url += `&sortBy=price&orderBy=-1`;\n    } else if (this.state.sort === \"stockAsc\") {\n      url += `&sortBy=stock&orderBy=1`;\n    } else if (this.state.sort === \"stockDesc\") {\n      url += `&sortBy=stock&orderBy=-1`;\n    }\n\n    axios\n      .get(url)\n      .then((res) => {\n        console.log(\"Products read\");\n        this.setState({ products: res.data });\n        this.setState({ category: \"all items\" });\n        const maxPrice = Math.max.apply(\n          Math,\n          this.state.products.map((p) => p.price)\n        );\n        const minPrice = Math.min.apply(\n          Math,\n          this.state.products.map((p) => p.price)\n        );\n\n        this.setState({ minPrice: minPrice });\n        this.setState({ maxPrice: maxPrice });\n        this.setState({ value: [minPrice, maxPrice] });\n\n        const productCategories = this.state.products.map(\n          (product) => product.categories\n        );\n\n        this.setState({\n          uniqueCategories: [...new Set(productCategories.flat(1))].sort(),\n        });\n\n        const productColours = this.state.products.map(\n          (product) => product.colours\n        );\n\n        this.setState({\n          uniqueColours: [...new Set(productColours.flat(1))].sort(),\n        });\n\n        this.setState({ loading: false });\n      })\n      .catch((err) => {\n        console.log(err.response.data);\n      });\n  };\n\n  fetchItems(url) {\n    axios\n      .get(url)\n      .then((res) => {\n        console.log(\"Records read\");\n        this.setState({\n          products: res.data,\n        });\n      })\n      .catch((err) => {\n        console.log(err.response.data);\n      });\n  }\n\n  handleCategoryFilter = (e) => {\n    let url = `${SERVER_HOST}/products?categories=${e.target.textContent.toLowerCase()}`;\n\n    this.setState({ category: e.target.textContent });\n\n    if (this.state.sort === \"nameAsc\") {\n      url += `&sortBy=productName&orderBy=1`;\n    } else if (this.state.sort === \"nameDesc\") {\n      url += `&sortBy=productName&orderBy=-1`;\n    } else if (this.state.sort === \"priceAsc\") {\n      url += `&sortBy=price&orderBy=1`;\n    } else if (this.state.sort === \"priceDesc\") {\n      url += `&sortBy=price&orderBy=-1`;\n    } else if (this.state.sort === \"stockAsc\") {\n      url += `&sortBy=stock&orderBy=1`;\n    } else if (this.state.sort === \"stockDesc\") {\n      url += `&sortBy=stock&orderBy=-1`;\n    }\n\n    this.fetchItems(url);\n  };\n\n  handlePriceFilter = (e, newVal) => {\n    this.setState({ value: newVal });\n\n    let url = `${SERVER_HOST}/products?`;\n    if (this.state.category !== \"all items\") {\n      url += `categories=${this.state.category.toLowerCase()}&minprice=${\n        this.state.value[0]\n      }&maxprice=${this.state.value[1]}`;\n\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    } else {\n      url += `&minprice=${this.state.value[0]}&maxprice=${this.state.value[1]}`;\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    }\n\n    if (this.state.sort === \"nameAsc\") {\n      url += `&sortBy=productName&orderBy=1`;\n    } else if (this.state.sort === \"nameDesc\") {\n      url += `&sortBy=productName&orderBy=-1`;\n    } else if (this.state.sort === \"priceAsc\") {\n      url += `&sortBy=price&orderBy=1`;\n    } else if (this.state.sort === \"priceDesc\") {\n      url += `&sortBy=price&orderBy=-1`;\n    } else if (this.state.sort === \"stockAsc\") {\n      url += `&sortBy=stock&orderBy=1`;\n    } else if (this.state.sort === \"stockDesc\") {\n      url += `&sortBy=stock&orderBy=-1`;\n    }\n\n    this.fetchItems(url);\n  };\n\n  handleColoursFilter = (e) => {\n    if (!this.state.colours.includes(e.target.textContent)) {\n      this.state.colours.push(e.target.textContent);\n    } else {\n      let index = this.state.colours.indexOf(e.target.textContent);\n      this.state.colours.splice(index, 1);\n    }\n\n    let url = `${SERVER_HOST}/products?`;\n    if (this.state.category !== \"all items\") {\n      url += `categories=${this.state.category.toLowerCase()}&minprice=${\n        this.state.value[0]\n      }&maxprice=${this.state.value[1]}`;\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    } else {\n      url += `&minprice=${this.state.value[0]}&maxprice=${this.state.value[1]}`;\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    }\n\n    if (this.state.sort === \"nameAsc\") {\n      url += `&sortBy=productName&orderBy=1`;\n    } else if (this.state.sort === \"nameDesc\") {\n      url += `&sortBy=productName&orderBy=-1`;\n    } else if (this.state.sort === \"priceAsc\") {\n      url += `&sortBy=price&orderBy=1`;\n    } else if (this.state.sort === \"priceDesc\") {\n      url += `&sortBy=price&orderBy=-1`;\n    } else if (this.state.sort === \"stockAsc\") {\n      url += `&sortBy=stock&orderBy=1`;\n    } else if (this.state.sort === \"stockDesc\") {\n      url += `&sortBy=stock&orderBy=-1`;\n    }\n\n    this.fetchItems(url);\n  };\n\n  handleSearch = (e) => {\n    this.setState({ searchQuery: e.target.value });\n    let url = `${SERVER_HOST}/products?`;\n\n    if (this.state.category !== \"all items\") {\n      url += `categories=${this.state.category.toLowerCase()}&q=${\n        e.target.value\n      }&minprice=${this.state.value[0]}&maxprice=${this.state.value[1]}`;\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    } else {\n      url += `q=${e.target.value}&minprice=${this.state.value[0]}&maxprice=${this.state.value[1]}`;\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    }\n\n    if (this.state.sort === \"nameAsc\") {\n      url += `&sortBy=productName&orderBy=1`;\n    } else if (this.state.sort === \"nameDesc\") {\n      url += `&sortBy=productName&orderBy=-1`;\n    } else if (this.state.sort === \"priceAsc\") {\n      url += `&sortBy=price&orderBy=1`;\n    } else if (this.state.sort === \"priceDesc\") {\n      url += `&sortBy=price&orderBy=-1`;\n    } else if (this.state.sort === \"stockAsc\") {\n      url += `&sortBy=stock&orderBy=1`;\n    } else if (this.state.sort === \"stockDesc\") {\n      url += `&sortBy=stock&orderBy=-1`;\n    }\n\n    this.fetchItems(url);\n  };\n\n  handleSort = (e) => {\n    let url = `${SERVER_HOST}/products?`;\n\n    if (this.state.category !== \"all items\") {\n      url += `categories=${this.state.category.toLowerCase()}&productName=${\n        this.state.searchQuery\n      }&minprice=${this.state.value[0]}&maxprice=${this.state.value[1]}`;\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    } else {\n      url += `productName=${this.state.searchQuery}&minprice=${this.state.value[0]}&maxprice=${this.state.value[1]}`;\n      this.state.colours.forEach((colour) => {\n        url += `&colours=${colour}`;\n      });\n    }\n\n    if (e.target.value === \"nameAsc\") {\n      url += `&sortBy=productName&orderBy=1`;\n      this.setState({ sort: e.target.value });\n    } else if (e.target.value === \"nameDesc\") {\n      url += `&sortBy=productName&orderBy=-1`;\n      this.setState({ sort: e.target.value });\n    } else if (e.target.value === \"priceAsc\") {\n      url += `&sortBy=price&orderBy=1`;\n      this.setState({ sort: e.target.value });\n    } else if (e.target.value === \"priceDesc\") {\n      url += `&sortBy=price&orderBy=-1`;\n      this.setState({ sort: e.target.value });\n    } else if (e.target.value === \"stockAsc\") {\n      url += `&sortBy=stock&orderBy=1`;\n      this.setState({ sort: e.target.value });\n    } else if (e.target.value === \"stockDesc\") {\n      url += `&sortBy=stock&orderBy=-1`;\n      this.setState({ sort: e.target.value });\n    } else {\n      this.setState({ sort: \"\" });\n    }\n\n    this.fetchItems(url);\n  };\n\n  render() {\n    return this.state.loading ? (\n      <Spinner animation=\"border\" role=\"status\">\n        <span className=\"visually-hidden\"></span>\n      </Spinner>\n    ) : (\n      <main>\n        <ShopBanner title={this.state.category} />\n        <section>\n          <div className=\"container\">\n            <div className=\"row\">\n              <SideBar\n                onFilter={this.handleCategoryFilter}\n                getAllItems={this.getAllItems}\n                onPriceFilter={this.handlePriceFilter}\n                value={this.state.value}\n                minPrice={this.state.minPrice}\n                maxPrice={this.state.maxPrice}\n                curMinPrice={this.state.value[0]}\n                curMaxPrice={this.state.value[1]}\n                uniqueCategories={this.state.uniqueCategories}\n                onColourFilter={this.handleColoursFilter}\n                uniqueColours={this.state.uniqueColours}\n                colours={this.state.colours}\n                onSearch={this.handleSearch}\n                curCategory={this.state.category}\n              />\n              <ShopGrid\n                products={this.state.products}\n                onSort={this.handleSort}\n              />\n            </div>\n          </div>\n        </section>\n      </main>\n    );\n  }\n}\n\nexport default Shop;\n"]},"metadata":{},"sourceType":"module"}