{"ast":null,"code":"import _classCallCheck from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import{SANDBOX_CLIENT_ID,SERVER_HOST}from\"../../config/global_constants\";import{PayPalButton}from\"react-paypal-button-v2\";import Swal from\"sweetalert2\";import axios from\"axios\";import{Redirect}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Checkout=/*#__PURE__*/function(_React$Component){_inherits(Checkout,_React$Component);var _super=_createSuper(Checkout);function Checkout(props){var _this;_classCallCheck(this,Checkout);_this=_super.call(this,props);_this.onSuccess=function(paymentData){console.log(\"PayPal payment was successful:\",paymentData);var url=\"\".concat(SERVER_HOST,\"/orders\");var orderDetails=new Object();orderDetails.paymentId=paymentData.id;orderDetails.amount=_this.props.amount;orderDetails.shippingCost=_this.props.shippingCost;orderDetails.userId=localStorage._id;orderDetails.products=[];_this.props.cartItems.map(function(item,index){orderDetails.products[index]={productId:item.productId,quantity:item.quantity};});var today=new Date();orderDetails.date=today;axios.post(url,orderDetails);localStorage.cart=\"null\";Swal.fire({title:\"PayPal payment was successful\",icon:\"success\",showConfirmButton:true,confirmButtonColor:\"#123c69\"}).then(function(res){if(res.isConfirmed){window.location.reload(false);_this.setState({redirectToHome:true});}});};_this.onError=function(errorData){console.log(\"PayPal error:\",errorData);Swal.fire({title:\"PayPal error\",text:\"No items in shopping cart\",icon:\"error\",showConfirmButton:true,confirmButtonColor:\"#123c69\"}).then(function(res){if(res.isConfirmed){}});};_this.onCancel=function(cancelData){// The user pressed the Paypal checkout popup window cancel button or closed the Paypal checkout popup window\nconsole.log(\"Payment cancelled by user:\",cancelData);Swal.fire({title:\"Payment cancelled by user\",icon:\"warning\",showConfirmButton:false,timer:2000});};_this.state={redirectToHome:false};return _this;}_createClass(Checkout,[{key:\"render\",value:function render(){var client_id=SANDBOX_CLIENT_ID;return/*#__PURE__*/_jsxs(\"div\",{children:[this.state.redirectToHome?/*#__PURE__*/_jsx(Redirect,{to:\"/shop\"}):null,/*#__PURE__*/_jsx(PayPalButton,{options:{clientId:client_id,currency:\"EUR\"},amount:this.props.amount,onSuccess:this.onSuccess,onError:this.onError,onCancel:this.onCancel})]});}}]);return Checkout;}(React.Component);export{Checkout as default};","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ShoppingCart/Checkout.jsx"],"names":["React","SANDBOX_CLIENT_ID","SERVER_HOST","PayPalButton","Swal","axios","Redirect","Checkout","props","onSuccess","paymentData","console","log","url","orderDetails","Object","paymentId","id","amount","shippingCost","userId","localStorage","_id","products","cartItems","map","item","index","productId","quantity","today","Date","date","post","cart","fire","title","icon","showConfirmButton","confirmButtonColor","then","res","isConfirmed","window","location","reload","setState","redirectToHome","onError","errorData","text","onCancel","cancelData","timer","state","client_id","clientId","currency","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { SANDBOX_CLIENT_ID, SERVER_HOST } from \"../../config/global_constants\";\nimport { PayPalButton } from \"react-paypal-button-v2\";\nimport Swal from \"sweetalert2\";\nimport axios from \"axios\";\nimport { Redirect } from \"react-router-dom\";\n\nexport default class Checkout extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      redirectToHome: false,\n    };\n  }\n  onSuccess = (paymentData) => {\n    console.log(\"PayPal payment was successful:\", paymentData);\n\n    let url = `${SERVER_HOST}/orders`;\n\n    let orderDetails = new Object();\n    orderDetails.paymentId = paymentData.id;\n    orderDetails.amount = this.props.amount;\n    orderDetails.shippingCost = this.props.shippingCost;\n    orderDetails.userId = localStorage._id;\n    orderDetails.products = [];\n\n    this.props.cartItems.map((item, index) => {\n      orderDetails.products[index] = {\n        productId: item.productId,\n        quantity: item.quantity,\n      };\n    });\n\n    let today = new Date();\n    orderDetails.date = today;\n\n    axios.post(url, orderDetails);\n\n    localStorage.cart = \"null\";\n\n    Swal.fire({\n      title: \"PayPal payment was successful\",\n      icon: \"success\",\n      showConfirmButton: true,\n      confirmButtonColor: \"#123c69\",\n    }).then((res) => {\n      if (res.isConfirmed) {\n        window.location.reload(false);\n        this.setState({ redirectToHome: true });\n      }\n    });\n  };\n\n  onError = (errorData) => {\n    console.log(\"PayPal error:\", errorData);\n    Swal.fire({\n      title: \"PayPal error\",\n      text: \"No items in shopping cart\",\n      icon: \"error\",\n      showConfirmButton: true,\n      confirmButtonColor: \"#123c69\",\n    }).then((res) => {\n      if (res.isConfirmed) {\n      }\n    });\n  };\n\n  onCancel = (cancelData) => {\n    // The user pressed the Paypal checkout popup window cancel button or closed the Paypal checkout popup window\n    console.log(\"Payment cancelled by user:\", cancelData);\n    Swal.fire({\n      title: \"Payment cancelled by user\",\n      icon: \"warning\",\n      showConfirmButton: false,\n      timer: 2000,\n    });\n  };\n\n  render() {\n    const client_id = SANDBOX_CLIENT_ID;\n\n    return (\n      <div>\n        {this.state.redirectToHome ? <Redirect to=\"/shop\" /> : null}\n        <PayPalButton\n          options={{\n            clientId: client_id,\n            currency: \"EUR\",\n          }}\n          amount={this.props.amount}\n          onSuccess={this.onSuccess}\n          onError={this.onError}\n          onCancel={this.onCancel}\n        />\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}