{"ast":null,"code":"import _toConsumableArray from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _defineProperty from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _classCallCheck from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import{Link,Redirect}from\"react-router-dom\";import{Form,Button,InputGroup}from\"react-bootstrap\";import{XLg}from\"react-bootstrap-icons\";import Swal from\"sweetalert2\";import axios from\"axios\";import{SERVER_HOST,CATEGORIES,COLOURS}from\"../../config/global_constants.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddProduct=/*#__PURE__*/function(_React$Component){_inherits(AddProduct,_React$Component);var _super=_createSuper(AddProduct);function AddProduct(props){var _this;_classCallCheck(this,AddProduct);_this=_super.call(this,props);_this.handleChange=function(e){_this.setState(_defineProperty({},e.target.name,e.target.value));};_this.handleFileChange=function(e){_this.setState({selectedFiles:e.target.files});};_this.addCategory=function(e){if(_this.state.selectedCategory!==\"\"&&!_this.state.categories.includes(_this.state.selectedCategory)){_this.setState({categories:[].concat(_toConsumableArray(_this.state.categories),[_this.state.selectedCategory])});}};_this.removeCategory=function(e){_this.setState({categories:_this.state.categories.filter(function(g){return g!==e.currentTarget.dataset.id;})});};_this.addColour=function(e){if(_this.state.selectedColours!==\"\"&&!_this.state.colours.includes(_this.state.selectedColours)){_this.setState({colours:[].concat(_toConsumableArray(_this.state.colours),[_this.state.selectedColours])});}};_this.removeColour=function(e){_this.setState({colours:_this.state.colours.filter(function(g){return g!==e.currentTarget.dataset.id;})});};_this.handleSubmit=function(e){e.preventDefault();axios.defaults.withCredentials=true;var formData=new FormData();formData.append(\"productName\",_this.state.productName);formData.append(\"price\",_this.state.price);formData.append(\"description\",_this.state.description);for(var i=0;i<_this.state.categories.length;i++){formData.append(\"categories\",_this.state.categories[i]);}formData.append(\"stock\",_this.state.stock);for(var _i=0;_i<_this.state.categories.length;_i++){formData.append(\"colours\",_this.state.colours[_i]);}if(_this.state.selectedFiles){for(var _i2=0;_i2<_this.state.selectedFiles.length;_i2++){formData.append(\"productPhotos\",_this.state.selectedFiles[_i2]);}}axios.post(\"\".concat(SERVER_HOST,\"/products\"),formData,{headers:{authorization:localStorage.token}}).then(function(res){console.log(\"Product added\");Swal.fire({title:\"Product added\",text:\"The product has been added.\",icon:\"success\",showConfirmButton:false,timer:1500});_this.setState({redirectToHome:true});}).catch(function(err){console.log(\"Product not added\");Swal.fire({title:\"Product not added\",text:err.response.data,icon:\"error\",showConfirmButton:true,confirmButtonColor:\"#123c69\"});});};_this.state={productName:\"\",price:\"\",description:\"\",categories:[],selectedCategory:\"\",stock:0,colours:[],selectedColours:\"\",selectedFiles:null,redirectToHome:false};return _this;}_createClass(AddProduct,[{key:\"validateProductName\",value:function validateProductName(){return this.state.productName!==\"\";}},{key:\"validateDescription\",value:function validateDescription(){return this.state.description!==\"\";}},{key:\"validatePrice\",value:function validatePrice(){return this.state.price>0;}},{key:\"validateCategories\",value:function validateCategories(){return this.state.categories.length!==0&&this.state.categories!==undefined;}},{key:\"validateStock\",value:function validateStock(){return this.state.stock>=0;}},{key:\"validateColours\",value:function validateColours(){return this.state.colours.length!==0&&this.state.colours!==undefined;}},{key:\"validatePhotos\",value:function validatePhotos(){return this.state.selectedFiles!==null&&this.state.selectedFiles.length>=2;}},{key:\"validate\",value:function validate(){return{productName:this.validateProductName(),description:this.validateDescription(),price:this.validatePrice(),categories:this.validateCategories(),stock:this.validateStock(),colours:this.validateColours(),photos:this.validatePhotos()};}},{key:\"render\",value:function render(){var _this2=this;var formInputsState=this.validate();var inputsAreAllValid=Object.keys(formInputsState).every(function(index){return formInputsState[index];});var productNameError=\"\";var priceError=\"\";var descriptionError=\"\";var categoriesError=\"\";var stockError=\"\";var coloursError=\"\";var photosError=\"\";if(!this.validateProductName()){productNameError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Product name is required.\"});}if(!this.validateDescription()){descriptionError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Product description is required.\"});}if(!this.validatePrice()){priceError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Price must be a positive number.\"});}if(!this.validateCategories()){categoriesError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Choose at least 1 category.\"});}if(!this.validateStock()){stockError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Stock must be a positive number.\"});}if(!this.validateColours()){coloursError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Choose at least 1 colour.\"});}if(!this.validatePhotos()){photosError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Choose at least 2 photos.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container p-3\",children:[this.state.redirectToHome?/*#__PURE__*/_jsx(Redirect,{to:\"/\"}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"card flex-column border-0 shadow rounded-3 overflow-hidden p-4 m-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\" text-center mt-3  \",children:\"Add Product\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-container m-4\",children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"productName\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"productName\",value:this.state.productName,onChange:this.handleChange}),productNameError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"price\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"price\",value:this.state.price,onChange:this.handleChange}),priceError]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"description\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Description\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"description\",as:\"textarea\",value:this.state.description,onChange:this.handleChange}),descriptionError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"categories\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Categories\"}),/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsxs(Form.Control,{name:\"selectedCategory\",as:\"select\",onChange:this.handleChange,defaultValue:\"DEFAULT\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"DEFAULT\",disabled:true,children:\"Select category...\"}),CATEGORIES.filter(function(g){return!_this2.state.categories.includes(g);}).map(function(g){return/*#__PURE__*/_jsx(\"option\",{value:g,children:g.toUpperCase()},g);})]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:this.addCategory,children:\"Add Category\"})]}),this.state.categories.map(function(g){return/*#__PURE__*/_jsxs(\"span\",{className:\"badge badge-secondary p-1 mt-2 mr-2\",children:[g.toUpperCase(),/*#__PURE__*/_jsx(XLg,{\"data-id\":g,className:\"ml-1\",onClick:_this2.removeCategory})]},g);}),categoriesError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"stock\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Stock\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",name:\"stock\",value:this.state.stock,onChange:this.handleChange}),stockError]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mt-2\",controlId:\"colours\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Colours\"}),/*#__PURE__*/_jsxs(InputGroup,{children:[/*#__PURE__*/_jsxs(Form.Control,{name:\"selectedColours\",as:\"select\",onChange:this.handleChange,defaultValue:\"DEFAULT\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"DEFAULT\",disabled:true,children:\"Select colour...\"}),Object.keys(COLOURS).filter(function(g){return!_this2.state.colours.includes(g);}).map(function(g){return/*#__PURE__*/_jsx(\"option\",{value:g,children:g.toUpperCase()},g);})]}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:this.addColour,children:\"Add Colour\"})]}),this.state.colours.map(function(g){return/*#__PURE__*/_jsxs(\"span\",{className:\"badge badge-secondary p-1 mt-2 mr-2\",children:[g.toUpperCase(),/*#__PURE__*/_jsx(XLg,{\"data-id\":g,className:\"ml-1\",onClick:_this2.removeColour})]},g);}),coloursError]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"photos\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Photos\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"file\",accept:\"image/png, image/jpg, image/jpeg\",multiple:true,onChange:this.handleFileChange}),photosError]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success mt-3 mr-2\",onClick:this.handleSubmit,disabled:!inputsAreAllValid,children:\"Add\"}),/*#__PURE__*/_jsx(Link,{to:\"/shop\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger mt-3 ml-2\",children:\"Cancel\"})})]})})]})]});}}]);return AddProduct;}(React.Component);export default AddProduct;","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ProductForms/AddProduct.jsx"],"names":["React","Link","Redirect","Form","Button","InputGroup","XLg","Swal","axios","SERVER_HOST","CATEGORIES","COLOURS","AddProduct","props","handleChange","e","setState","target","name","value","handleFileChange","selectedFiles","files","addCategory","state","selectedCategory","categories","includes","removeCategory","filter","g","currentTarget","dataset","id","addColour","selectedColours","colours","removeColour","handleSubmit","preventDefault","defaults","withCredentials","formData","FormData","append","productName","price","description","i","length","stock","post","headers","authorization","localStorage","token","then","res","console","log","fire","title","text","icon","showConfirmButton","timer","redirectToHome","catch","err","response","data","confirmButtonColor","undefined","validateProductName","validateDescription","validatePrice","validateCategories","validateStock","validateColours","photos","validatePhotos","formInputsState","validate","inputsAreAllValid","Object","keys","every","index","productNameError","priceError","descriptionError","categoriesError","stockError","coloursError","photosError","map","toUpperCase","Component"],"mappings":"g2BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,CAAeC,QAAf,KAA+B,kBAA/B,CACA,OAASC,IAAT,CAAeC,MAAf,CAAuBC,UAAvB,KAAyC,iBAAzC,CACA,OAASC,GAAT,KAAoB,uBAApB,CACA,MAAOC,CAAAA,IAAP,KAAiB,aAAjB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OACEC,WADF,CAEEC,UAFF,CAGEC,OAHF,KAIO,kCAJP,C,2FAMMC,CAAAA,U,oHACJ,oBAAYC,KAAZ,CAAmB,4CACjB,uBAAMA,KAAN,EADiB,MAgBnBC,YAhBmB,CAgBJ,SAACC,CAAD,CAAO,CACpB,MAAKC,QAAL,oBAAiBD,CAAC,CAACE,MAAF,CAASC,IAA1B,CAAiCH,CAAC,CAACE,MAAF,CAASE,KAA1C,GACD,CAlBkB,OAoBnBC,gBApBmB,CAoBA,SAACL,CAAD,CAAO,CACxB,MAAKC,QAAL,CAAc,CAAEK,aAAa,CAAEN,CAAC,CAACE,MAAF,CAASK,KAA1B,CAAd,EACD,CAtBkB,OAwBnBC,WAxBmB,CAwBL,SAACR,CAAD,CAAO,CACnB,GACE,MAAKS,KAAL,CAAWC,gBAAX,GAAgC,EAAhC,EACA,CAAC,MAAKD,KAAL,CAAWE,UAAX,CAAsBC,QAAtB,CAA+B,MAAKH,KAAL,CAAWC,gBAA1C,CAFH,CAGE,CACA,MAAKT,QAAL,CAAc,CACZU,UAAU,8BAAM,MAAKF,KAAL,CAAWE,UAAjB,GAA6B,MAAKF,KAAL,CAAWC,gBAAxC,EADE,CAAd,EAGD,CACF,CAjCkB,OAmCnBG,cAnCmB,CAmCF,SAACb,CAAD,CAAO,CACtB,MAAKC,QAAL,CAAc,CACZU,UAAU,CAAE,MAAKF,KAAL,CAAWE,UAAX,CAAsBG,MAAtB,CACV,SAACC,CAAD,QAAOA,CAAAA,CAAC,GAAKf,CAAC,CAACgB,aAAF,CAAgBC,OAAhB,CAAwBC,EAArC,EADU,CADA,CAAd,EAKD,CAzCkB,OA2CnBC,SA3CmB,CA2CP,SAACnB,CAAD,CAAO,CACjB,GACE,MAAKS,KAAL,CAAWW,eAAX,GAA+B,EAA/B,EACA,CAAC,MAAKX,KAAL,CAAWY,OAAX,CAAmBT,QAAnB,CAA4B,MAAKH,KAAL,CAAWW,eAAvC,CAFH,CAGE,CACA,MAAKnB,QAAL,CAAc,CACZoB,OAAO,8BAAM,MAAKZ,KAAL,CAAWY,OAAjB,GAA0B,MAAKZ,KAAL,CAAWW,eAArC,EADK,CAAd,EAGD,CACF,CApDkB,OAsDnBE,YAtDmB,CAsDJ,SAACtB,CAAD,CAAO,CACpB,MAAKC,QAAL,CAAc,CACZoB,OAAO,CAAE,MAAKZ,KAAL,CAAWY,OAAX,CAAmBP,MAAnB,CACP,SAACC,CAAD,QAAOA,CAAAA,CAAC,GAAKf,CAAC,CAACgB,aAAF,CAAgBC,OAAhB,CAAwBC,EAArC,EADO,CADG,CAAd,EAKD,CA5DkB,OA8DnBK,YA9DmB,CA8DJ,SAACvB,CAAD,CAAO,CACpBA,CAAC,CAACwB,cAAF,GAEA/B,KAAK,CAACgC,QAAN,CAAeC,eAAf,CAAiC,IAAjC,CAEA,GAAIC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAf,CAEAD,QAAQ,CAACE,MAAT,CAAgB,aAAhB,CAA+B,MAAKpB,KAAL,CAAWqB,WAA1C,EACAH,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyB,MAAKpB,KAAL,CAAWsB,KAApC,EACAJ,QAAQ,CAACE,MAAT,CAAgB,aAAhB,CAA+B,MAAKpB,KAAL,CAAWuB,WAA1C,EACA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,MAAKxB,KAAL,CAAWE,UAAX,CAAsBuB,MAA1C,CAAkDD,CAAC,EAAnD,CAAuD,CACrDN,QAAQ,CAACE,MAAT,CAAgB,YAAhB,CAA8B,MAAKpB,KAAL,CAAWE,UAAX,CAAsBsB,CAAtB,CAA9B,EACD,CACDN,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyB,MAAKpB,KAAL,CAAW0B,KAApC,EACA,IAAK,GAAIF,CAAAA,EAAC,CAAG,CAAb,CAAgBA,EAAC,CAAG,MAAKxB,KAAL,CAAWE,UAAX,CAAsBuB,MAA1C,CAAkDD,EAAC,EAAnD,CAAuD,CACrDN,QAAQ,CAACE,MAAT,CAAgB,SAAhB,CAA2B,MAAKpB,KAAL,CAAWY,OAAX,CAAmBY,EAAnB,CAA3B,EACD,CAED,GAAI,MAAKxB,KAAL,CAAWH,aAAf,CAA8B,CAC5B,IAAK,GAAI2B,CAAAA,GAAC,CAAG,CAAb,CAAgBA,GAAC,CAAG,MAAKxB,KAAL,CAAWH,aAAX,CAAyB4B,MAA7C,CAAqDD,GAAC,EAAtD,CAA0D,CACxDN,QAAQ,CAACE,MAAT,CAAgB,eAAhB,CAAiC,MAAKpB,KAAL,CAAWH,aAAX,CAAyB2B,GAAzB,CAAjC,EACD,CACF,CAEDxC,KAAK,CACF2C,IADH,WACW1C,WADX,cACmCiC,QADnC,CAC6C,CACzCU,OAAO,CAAE,CAAEC,aAAa,CAAEC,YAAY,CAACC,KAA9B,CADgC,CAD7C,EAIGC,IAJH,CAIQ,SAACC,GAAD,CAAS,CACbC,OAAO,CAACC,GAAR,CAAY,eAAZ,EACApD,IAAI,CAACqD,IAAL,CAAU,CACRC,KAAK,CAAE,eADC,CAERC,IAAI,CAAE,6BAFE,CAGRC,IAAI,CAAE,SAHE,CAIRC,iBAAiB,CAAE,KAJX,CAKRC,KAAK,CAAE,IALC,CAAV,EAOA,MAAKjD,QAAL,CAAc,CAAEkD,cAAc,CAAE,IAAlB,CAAd,EACD,CAdH,EAeGC,KAfH,CAeS,SAACC,GAAD,CAAS,CACdV,OAAO,CAACC,GAAR,CAAY,mBAAZ,EACApD,IAAI,CAACqD,IAAL,CAAU,CACRC,KAAK,CAAE,mBADC,CAERC,IAAI,CAAEM,GAAG,CAACC,QAAJ,CAAaC,IAFX,CAGRP,IAAI,CAAE,OAHE,CAIRC,iBAAiB,CAAE,IAJX,CAKRO,kBAAkB,CAAE,SALZ,CAAV,EAOD,CAxBH,EAyBD,CA/GkB,CAEjB,MAAK/C,KAAL,CAAa,CACXqB,WAAW,CAAE,EADF,CAEXC,KAAK,CAAE,EAFI,CAGXC,WAAW,CAAE,EAHF,CAIXrB,UAAU,CAAE,EAJD,CAKXD,gBAAgB,CAAE,EALP,CAMXyB,KAAK,CAAE,CANI,CAOXd,OAAO,CAAE,EAPE,CAQXD,eAAe,CAAE,EARN,CASXd,aAAa,CAAE,IATJ,CAUX6C,cAAc,CAAE,KAVL,CAAb,CAFiB,aAclB,C,0DAmGD,8BAAsB,CACpB,MAAO,MAAK1C,KAAL,CAAWqB,WAAX,GAA2B,EAAlC,CACD,C,mCAED,8BAAsB,CACpB,MAAO,MAAKrB,KAAL,CAAWuB,WAAX,GAA2B,EAAlC,CACD,C,6BAED,wBAAgB,CACd,MAAO,MAAKvB,KAAL,CAAWsB,KAAX,CAAmB,CAA1B,CACD,C,kCAED,6BAAqB,CACnB,MACE,MAAKtB,KAAL,CAAWE,UAAX,CAAsBuB,MAAtB,GAAiC,CAAjC,EAAsC,KAAKzB,KAAL,CAAWE,UAAX,GAA0B8C,SADlE,CAGD,C,6BAED,wBAAgB,CACd,MAAO,MAAKhD,KAAL,CAAW0B,KAAX,EAAoB,CAA3B,CACD,C,+BAED,0BAAkB,CAChB,MAAO,MAAK1B,KAAL,CAAWY,OAAX,CAAmBa,MAAnB,GAA8B,CAA9B,EAAmC,KAAKzB,KAAL,CAAWY,OAAX,GAAuBoC,SAAjE,CACD,C,8BAED,yBAAiB,CACf,MACE,MAAKhD,KAAL,CAAWH,aAAX,GAA6B,IAA7B,EAAqC,KAAKG,KAAL,CAAWH,aAAX,CAAyB4B,MAAzB,EAAmC,CAD1E,CAGD,C,wBAED,mBAAW,CACT,MAAO,CACLJ,WAAW,CAAE,KAAK4B,mBAAL,EADR,CAEL1B,WAAW,CAAE,KAAK2B,mBAAL,EAFR,CAGL5B,KAAK,CAAE,KAAK6B,aAAL,EAHF,CAILjD,UAAU,CAAE,KAAKkD,kBAAL,EAJP,CAKL1B,KAAK,CAAE,KAAK2B,aAAL,EALF,CAMLzC,OAAO,CAAE,KAAK0C,eAAL,EANJ,CAOLC,MAAM,CAAE,KAAKC,cAAL,EAPH,CAAP,CASD,C,sBAED,iBAAS,iBACP,GAAMC,CAAAA,eAAe,CAAG,KAAKC,QAAL,EAAxB,CACA,GAAMC,CAAAA,iBAAiB,CAAGC,MAAM,CAACC,IAAP,CAAYJ,eAAZ,EAA6BK,KAA7B,CACxB,SAACC,KAAD,QAAWN,CAAAA,eAAe,CAACM,KAAD,CAA1B,EADwB,CAA1B,CAIA,GAAIC,CAAAA,gBAAgB,CAAG,EAAvB,CACA,GAAIC,CAAAA,UAAU,CAAG,EAAjB,CACA,GAAIC,CAAAA,gBAAgB,CAAG,EAAvB,CACA,GAAIC,CAAAA,eAAe,CAAG,EAAtB,CACA,GAAIC,CAAAA,UAAU,CAAG,EAAjB,CACA,GAAIC,CAAAA,YAAY,CAAG,EAAnB,CACA,GAAIC,CAAAA,WAAW,CAAG,EAAlB,CAEA,GAAI,CAAC,KAAKrB,mBAAL,EAAL,CAAiC,CAC/Be,gBAAgB,cACd,UAAG,SAAS,CAAC,kBAAb,uCADF,CAGD,CACD,GAAI,CAAC,KAAKd,mBAAL,EAAL,CAAiC,CAC/BgB,gBAAgB,cACd,UAAG,SAAS,CAAC,kBAAb,8CADF,CAGD,CACD,GAAI,CAAC,KAAKf,aAAL,EAAL,CAA2B,CACzBc,UAAU,cACR,UAAG,SAAS,CAAC,kBAAb,8CADF,CAGD,CACD,GAAI,CAAC,KAAKb,kBAAL,EAAL,CAAgC,CAC9Be,eAAe,cACb,UAAG,SAAS,CAAC,kBAAb,yCADF,CAGD,CACD,GAAI,CAAC,KAAKd,aAAL,EAAL,CAA2B,CACzBe,UAAU,cACR,UAAG,SAAS,CAAC,kBAAb,8CADF,CAGD,CACD,GAAI,CAAC,KAAKd,eAAL,EAAL,CAA6B,CAC3Be,YAAY,cACV,UAAG,SAAS,CAAC,kBAAb,uCADF,CAGD,CACD,GAAI,CAAC,KAAKb,cAAL,EAAL,CAA4B,CAC1Bc,WAAW,cACT,UAAG,SAAS,CAAC,kBAAb,uCADF,CAGD,CAED,mBACE,aAAK,SAAS,CAAC,eAAf,WACG,KAAKtE,KAAL,CAAW0C,cAAX,cAA4B,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAA5B,CAAkD,IADrD,cAGE,aAAK,SAAS,CAAC,oEAAf,wBACE,WAAI,SAAS,CAAC,qBAAd,yBADF,cAEE,YAAK,SAAS,CAAC,oBAAf,uBACE,MAAC,IAAD,yBACE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,aAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,2BADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,aAFP,CAGE,KAAK,CAAE,KAAK1C,KAAL,CAAWqB,WAHpB,CAIE,QAAQ,CAAE,KAAK/B,YAJjB,EAFF,CAQG0E,gBARH,GADF,cAWE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,OAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,oBADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,OAFP,CAGE,KAAK,CAAE,KAAKhE,KAAL,CAAWsB,KAHpB,CAIE,QAAQ,CAAE,KAAKhC,YAJjB,EAFF,CAQG2E,UARH,GAXF,cAqBE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,aAAtB,wBACE,KAAC,IAAD,CAAM,KAAN,0BADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,aAFP,CAGE,EAAE,CAAC,UAHL,CAIE,KAAK,CAAE,KAAKjE,KAAL,CAAWuB,WAJpB,CAKE,QAAQ,CAAE,KAAKjC,YALjB,EAFF,CASG4E,gBATH,GArBF,cAgCE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,YAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,yBADF,cAEE,MAAC,UAAD,yBACE,MAAC,IAAD,CAAM,OAAN,EACE,IAAI,CAAC,kBADP,CAEE,EAAE,CAAC,QAFL,CAGE,QAAQ,CAAE,KAAK5E,YAHjB,CAIE,YAAY,CAAE,SAJhB,wBAME,eAAQ,KAAK,CAAC,SAAd,CAAwB,QAAQ,KAAhC,gCANF,CASGJ,UAAU,CAACmB,MAAX,CACC,SAACC,CAAD,QAAO,CAAC,MAAI,CAACN,KAAL,CAAWE,UAAX,CAAsBC,QAAtB,CAA+BG,CAA/B,CAAR,EADD,EAECiE,GAFD,CAEK,SAACjE,CAAD,qBACJ,eAAgB,KAAK,CAAEA,CAAvB,UACGA,CAAC,CAACkE,WAAF,EADH,EAAalE,CAAb,CADI,EAFL,CATH,GADF,cAmBE,KAAC,MAAD,EACE,OAAO,CAAC,mBADV,CAEE,OAAO,CAAE,KAAKP,WAFhB,0BAnBF,GAFF,CA4BG,KAAKC,KAAL,CAAWE,UAAX,CAAsBqE,GAAtB,CAA0B,SAACjE,CAAD,qBACzB,cAAM,SAAS,CAAC,qCAAhB,WACGA,CAAC,CAACkE,WAAF,EADH,cAEE,KAAC,GAAD,EACE,UAASlE,CADX,CAEE,SAAS,CAAC,MAFZ,CAGE,OAAO,CAAE,MAAI,CAACF,cAHhB,EAFF,GAA2DE,CAA3D,CADyB,EAA1B,CA5BH,CAsCG6D,eAtCH,GAhCF,cAwEE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,OAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,oBADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,IAAI,CAAC,MADP,CAEE,IAAI,CAAC,OAFP,CAGE,KAAK,CAAE,KAAKnE,KAAL,CAAW0B,KAHpB,CAIE,QAAQ,CAAE,KAAKpC,YAJjB,EAFF,CAQG8E,UARH,GAxEF,cAkFE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,MAAtB,CAA6B,SAAS,CAAC,SAAvC,wBACE,KAAC,IAAD,CAAM,KAAN,sBADF,cAEE,MAAC,UAAD,yBACE,MAAC,IAAD,CAAM,OAAN,EACE,IAAI,CAAC,iBADP,CAEE,EAAE,CAAC,QAFL,CAGE,QAAQ,CAAE,KAAK9E,YAHjB,CAIE,YAAY,CAAE,SAJhB,wBAME,eAAQ,KAAK,CAAC,SAAd,CAAwB,QAAQ,KAAhC,8BANF,CASGsE,MAAM,CAACC,IAAP,CAAY1E,OAAZ,EACEkB,MADF,CACS,SAACC,CAAD,QAAO,CAAC,MAAI,CAACN,KAAL,CAAWY,OAAX,CAAmBT,QAAnB,CAA4BG,CAA5B,CAAR,EADT,EAEEiE,GAFF,CAEM,SAACjE,CAAD,qBACH,eAAgB,KAAK,CAAEA,CAAvB,UACGA,CAAC,CAACkE,WAAF,EADH,EAAalE,CAAb,CADG,EAFN,CATH,GADF,cAmBE,KAAC,MAAD,EAAQ,OAAO,CAAC,mBAAhB,CAAoC,OAAO,CAAE,KAAKI,SAAlD,wBAnBF,GAFF,CAyBG,KAAKV,KAAL,CAAWY,OAAX,CAAmB2D,GAAnB,CAAuB,SAACjE,CAAD,qBACtB,cAAM,SAAS,CAAC,qCAAhB,WACGA,CAAC,CAACkE,WAAF,EADH,cAEE,KAAC,GAAD,EACE,UAASlE,CADX,CAEE,SAAS,CAAC,MAFZ,CAGE,OAAO,CAAE,MAAI,CAACO,YAHhB,EAFF,GAA2DP,CAA3D,CADsB,EAAvB,CAzBH,CAmCG+D,YAnCH,GAlFF,cAuHE,MAAC,IAAD,CAAM,KAAN,EAAY,SAAS,CAAC,QAAtB,wBACE,KAAC,IAAD,CAAM,KAAN,qBADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,IAAI,CAAC,MADP,CAEE,MAAM,CAAC,kCAFT,CAGE,QAAQ,KAHV,CAIE,QAAQ,CAAE,KAAKzE,gBAJjB,EAFF,CAQG0E,WARH,GAvHF,cAkIE,aAlIF,cAoIE,eACE,SAAS,CAAC,2BADZ,CAEE,OAAO,CAAE,KAAKxD,YAFhB,CAGE,QAAQ,CAAE,CAAC6C,iBAHb,iBApIF,cA2IE,KAAC,IAAD,EAAM,EAAE,CAAE,OAAV,uBACE,eAAQ,SAAS,CAAC,0BAAlB,oBADF,EA3IF,GADF,EAFF,GAHF,GADF,CA0JD,C,wBA1WsBnF,KAAK,CAACiG,S,EA6W/B,cAAerF,CAAAA,UAAf","sourcesContent":["import React from \"react\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { Form, Button, InputGroup } from \"react-bootstrap\";\nimport { XLg } from \"react-bootstrap-icons\";\nimport Swal from \"sweetalert2\";\nimport axios from \"axios\";\nimport {\n  SERVER_HOST,\n  CATEGORIES,\n  COLOURS,\n} from \"../../config/global_constants.js\";\n\nclass AddProduct extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      productName: \"\",\n      price: \"\",\n      description: \"\",\n      categories: [],\n      selectedCategory: \"\",\n      stock: 0,\n      colours: [],\n      selectedColours: \"\",\n      selectedFiles: null,\n      redirectToHome: false,\n    };\n  }\n\n  handleChange = (e) => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n\n  handleFileChange = (e) => {\n    this.setState({ selectedFiles: e.target.files });\n  };\n\n  addCategory = (e) => {\n    if (\n      this.state.selectedCategory !== \"\" &&\n      !this.state.categories.includes(this.state.selectedCategory)\n    ) {\n      this.setState({\n        categories: [...this.state.categories, this.state.selectedCategory],\n      });\n    }\n  };\n\n  removeCategory = (e) => {\n    this.setState({\n      categories: this.state.categories.filter(\n        (g) => g !== e.currentTarget.dataset.id\n      ),\n    });\n  };\n\n  addColour = (e) => {\n    if (\n      this.state.selectedColours !== \"\" &&\n      !this.state.colours.includes(this.state.selectedColours)\n    ) {\n      this.setState({\n        colours: [...this.state.colours, this.state.selectedColours],\n      });\n    }\n  };\n\n  removeColour = (e) => {\n    this.setState({\n      colours: this.state.colours.filter(\n        (g) => g !== e.currentTarget.dataset.id\n      ),\n    });\n  };\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n\n    axios.defaults.withCredentials = true;\n\n    let formData = new FormData();\n\n    formData.append(\"productName\", this.state.productName);\n    formData.append(\"price\", this.state.price);\n    formData.append(\"description\", this.state.description);\n    for (let i = 0; i < this.state.categories.length; i++) {\n      formData.append(\"categories\", this.state.categories[i]);\n    }\n    formData.append(\"stock\", this.state.stock);\n    for (let i = 0; i < this.state.categories.length; i++) {\n      formData.append(\"colours\", this.state.colours[i]);\n    }\n\n    if (this.state.selectedFiles) {\n      for (let i = 0; i < this.state.selectedFiles.length; i++) {\n        formData.append(\"productPhotos\", this.state.selectedFiles[i]);\n      }\n    }\n\n    axios\n      .post(`${SERVER_HOST}/products`, formData, {\n        headers: { authorization: localStorage.token },\n      })\n      .then((res) => {\n        console.log(\"Product added\");\n        Swal.fire({\n          title: \"Product added\",\n          text: \"The product has been added.\",\n          icon: \"success\",\n          showConfirmButton: false,\n          timer: 1500,\n        });\n        this.setState({ redirectToHome: true });\n      })\n      .catch((err) => {\n        console.log(\"Product not added\");\n        Swal.fire({\n          title: \"Product not added\",\n          text: err.response.data,\n          icon: \"error\",\n          showConfirmButton: true,\n          confirmButtonColor: \"#123c69\",\n        });\n      });\n  };\n\n  validateProductName() {\n    return this.state.productName !== \"\";\n  }\n\n  validateDescription() {\n    return this.state.description !== \"\";\n  }\n\n  validatePrice() {\n    return this.state.price > 0;\n  }\n\n  validateCategories() {\n    return (\n      this.state.categories.length !== 0 && this.state.categories !== undefined\n    );\n  }\n\n  validateStock() {\n    return this.state.stock >= 0;\n  }\n\n  validateColours() {\n    return this.state.colours.length !== 0 && this.state.colours !== undefined;\n  }\n\n  validatePhotos() {\n    return (\n      this.state.selectedFiles !== null && this.state.selectedFiles.length >= 2\n    );\n  }\n\n  validate() {\n    return {\n      productName: this.validateProductName(),\n      description: this.validateDescription(),\n      price: this.validatePrice(),\n      categories: this.validateCategories(),\n      stock: this.validateStock(),\n      colours: this.validateColours(),\n      photos: this.validatePhotos(),\n    };\n  }\n\n  render() {\n    const formInputsState = this.validate();\n    const inputsAreAllValid = Object.keys(formInputsState).every(\n      (index) => formInputsState[index]\n    );\n\n    let productNameError = \"\";\n    let priceError = \"\";\n    let descriptionError = \"\";\n    let categoriesError = \"\";\n    let stockError = \"\";\n    let coloursError = \"\";\n    let photosError = \"\";\n\n    if (!this.validateProductName()) {\n      productNameError = (\n        <p className=\"text-danger mt-2\">Product name is required.</p>\n      );\n    }\n    if (!this.validateDescription()) {\n      descriptionError = (\n        <p className=\"text-danger mt-2\">Product description is required.</p>\n      );\n    }\n    if (!this.validatePrice()) {\n      priceError = (\n        <p className=\"text-danger mt-2\">Price must be a positive number.</p>\n      );\n    }\n    if (!this.validateCategories()) {\n      categoriesError = (\n        <p className=\"text-danger mt-2\">Choose at least 1 category.</p>\n      );\n    }\n    if (!this.validateStock()) {\n      stockError = (\n        <p className=\"text-danger mt-2\">Stock must be a positive number.</p>\n      );\n    }\n    if (!this.validateColours()) {\n      coloursError = (\n        <p className=\"text-danger mt-2\">Choose at least 1 colour.</p>\n      );\n    }\n    if (!this.validatePhotos()) {\n      photosError = (\n        <p className=\"text-danger mt-2\">Choose at least 2 photos.</p>\n      );\n    }\n\n    return (\n      <div className=\"container p-3\">\n        {this.state.redirectToHome ? <Redirect to=\"/\" /> : null}\n\n        <div className=\"card flex-column border-0 shadow rounded-3 overflow-hidden p-4 m-4\">\n          <h2 className=\" text-center mt-3  \">Add Product</h2>\n          <div className=\"form-container m-4\">\n            <Form>\n              <Form.Group className=\"mt-2\" controlId=\"productName\">\n                <Form.Label>Product Name</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"productName\"\n                  value={this.state.productName}\n                  onChange={this.handleChange}\n                />\n                {productNameError}\n              </Form.Group>\n              <Form.Group className=\"mt-2\" controlId=\"price\">\n                <Form.Label>Price</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"price\"\n                  value={this.state.price}\n                  onChange={this.handleChange}\n                />\n                {priceError}\n              </Form.Group>\n              <Form.Group controlId=\"description\">\n                <Form.Label>Description</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"description\"\n                  as=\"textarea\"\n                  value={this.state.description}\n                  onChange={this.handleChange}\n                />\n                {descriptionError}\n              </Form.Group>\n              <Form.Group className=\"mt-2\" controlId=\"categories\">\n                <Form.Label>Categories</Form.Label>\n                <InputGroup>\n                  <Form.Control\n                    name=\"selectedCategory\"\n                    as=\"select\"\n                    onChange={this.handleChange}\n                    defaultValue={\"DEFAULT\"}\n                  >\n                    <option value=\"DEFAULT\" disabled>\n                      Select category...\n                    </option>\n                    {CATEGORIES.filter(\n                      (g) => !this.state.categories.includes(g)\n                    ).map((g) => (\n                      <option key={g} value={g}>\n                        {g.toUpperCase()}\n                      </option>\n                    ))}\n                  </Form.Control>\n\n                  <Button\n                    variant=\"outline-secondary\"\n                    onClick={this.addCategory}\n                  >\n                    Add Category\n                  </Button>\n                </InputGroup>\n                {this.state.categories.map((g) => (\n                  <span className=\"badge badge-secondary p-1 mt-2 mr-2\" key={g}>\n                    {g.toUpperCase()}\n                    <XLg\n                      data-id={g}\n                      className=\"ml-1\"\n                      onClick={this.removeCategory}\n                    />\n                  </span>\n                ))}\n                {categoriesError}\n              </Form.Group>\n              <Form.Group className=\"mt-2\" controlId=\"stock\">\n                <Form.Label>Stock</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"stock\"\n                  value={this.state.stock}\n                  onChange={this.handleChange}\n                />\n                {stockError}\n              </Form.Group>\n              <Form.Group className=\"mt-2\" controlId=\"colours\">\n                <Form.Label>Colours</Form.Label>\n                <InputGroup>\n                  <Form.Control\n                    name=\"selectedColours\"\n                    as=\"select\"\n                    onChange={this.handleChange}\n                    defaultValue={\"DEFAULT\"}\n                  >\n                    <option value=\"DEFAULT\" disabled>\n                      Select colour...\n                    </option>\n                    {Object.keys(COLOURS)\n                      .filter((g) => !this.state.colours.includes(g))\n                      .map((g) => (\n                        <option key={g} value={g}>\n                          {g.toUpperCase()}\n                        </option>\n                      ))}\n                  </Form.Control>\n\n                  <Button variant=\"outline-secondary\" onClick={this.addColour}>\n                    Add Colour\n                  </Button>\n                </InputGroup>\n                {this.state.colours.map((g) => (\n                  <span className=\"badge badge-secondary p-1 mt-2 mr-2\" key={g}>\n                    {g.toUpperCase()}\n                    <XLg\n                      data-id={g}\n                      className=\"ml-1\"\n                      onClick={this.removeColour}\n                    />\n                  </span>\n                ))}\n                {coloursError}\n              </Form.Group>\n              <Form.Group controlId=\"photos\">\n                <Form.Label>Photos</Form.Label>\n                <Form.Control\n                  type=\"file\"\n                  accept=\"image/png, image/jpg, image/jpeg\"\n                  multiple\n                  onChange={this.handleFileChange}\n                />\n                {photosError}\n              </Form.Group>\n\n              <br />\n\n              <button\n                className=\"btn btn-success mt-3 mr-2\"\n                onClick={this.handleSubmit}\n                disabled={!inputsAreAllValid}\n              >\n                Add\n              </button>\n              <Link to={\"/shop\"}>\n                <button className=\"btn btn-danger mt-3 ml-2\">Cancel</button>\n              </Link>\n            </Form>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default AddProduct;\n"]},"metadata":{},"sourceType":"module"}