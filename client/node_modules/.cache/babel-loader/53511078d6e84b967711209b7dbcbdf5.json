{"ast":null,"code":"var _jsxFileName = \"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/Account/Profile.jsx\";\nimport React from \"react\";\nimport { Form } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { Redirect, withRouter } from \"react-router-dom\";\nimport { SERVER_HOST } from \"../../config/global_constants\";\nimport Swal from \"sweetalert2\";\nimport PhoneInput from \"react-phone-input-2\";\nimport \"react-phone-input-2/lib/style.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Profile extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleFileChange = e => {\n      this.setState({\n        selectedFile: e.target.files[0]\n      });\n    };\n\n    this.handleChange = e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      axios.defaults.withCredentials = true;\n      let formData = new FormData();\n      formData.append(\"name\", this.state.name);\n      formData.append(\"email\", this.state.email);\n      formData.append(\"phone\", this.state.phone);\n      formData.append(\"profilePhoto\", this.state.selectedFile);\n      axios.put(`${SERVER_HOST}/users/${this.props.match.params.id}`, formData, {\n        headers: {\n          authorization: localStorage.token,\n          \"Content-type\": \"multipart/form-data\"\n        }\n      }).then(res => {\n        if (res.data) {\n          if (res.data.errorMessage) {\n            console.log(res.data.errorMessage);\n            Swal.fire({\n              title: \"Changes not saved\",\n              text: res.data.errorMessage,\n              icon: \"error\",\n              confirmButtonColor: \"#123c69\",\n              showConfirmButton: true\n            });\n          } else {\n            console.log(\"Changes saved\");\n\n            if (this.state.selectedFile !== null) {\n              localStorage.profilePhoto = res.data.profilePhoto;\n            }\n\n            Swal.fire({\n              title: \"Changes saved\",\n              text: \"User details have been updated.\",\n              icon: \"success\",\n              showConfirmButton: false,\n              timer: 1500\n            });\n            this.setState({\n              redirectToHome: true\n            });\n          }\n        } else {\n          console.log(\"Changes not saved\");\n          Swal.fire({\n            title: \"Changes not saved\",\n            text: \"Make sure that data is valid.\",\n            icon: \"error\",\n            confirmButtonColor: \"#123c69\",\n            showConfirmButton: true\n          });\n        }\n      });\n    };\n\n    this.state = {\n      name: \"\",\n      email: \"\",\n      phone: \"\",\n      selectedFile: null,\n      profilePhoto: \"\"\n    };\n  }\n\n  componentDidMount() {\n    axios.defaults.withCredentials = true;\n    axios.get(`${SERVER_HOST}/users/${this.props.match.params.id}`, {\n      headers: {\n        authorization: localStorage.token\n      }\n    }).then(res => {\n      if (res.data) {\n        if (res.data.errorMessage) {\n          console.log(res.data.errorMessage);\n        } else {\n          this.setState({\n            name: res.data.name,\n            email: res.data.email,\n            phone: res.data.phone,\n            profilePhoto: res.data.profilePhoto\n          });\n        }\n      } else {\n        console.log(`Product not found`);\n      }\n    });\n  }\n\n  validateName() {\n    return this.state.name !== \"\";\n  }\n\n  validateEmail() {\n    return /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(this.state.email);\n  }\n\n  validatePhone() {\n    return this.state.phone.length === 0 || this.state.phone.length >= 10;\n  }\n\n  validate() {\n    return {\n      name: this.validateName(),\n      email: this.validateEmail(),\n      phone: this.validatePhone()\n    };\n  }\n\n  render() {\n    const formInputsState = this.validate();\n    const inputsAreAllValid = Object.keys(formInputsState).every(index => formInputsState[index]);\n    let nameError = \"\";\n    let emailError = \"\";\n    let phoneError = \"\";\n\n    if (!this.validateName()) {\n      nameError = /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-danger mt-2\",\n        children: \"User name is required.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 19\n      }, this);\n    }\n\n    if (!this.validateEmail()) {\n      emailError = /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-danger mt-2\",\n        children: \"Invalid email.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 20\n      }, this);\n    }\n\n    if (!this.validatePhone()) {\n      phoneError = /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-danger mt-2\",\n        children: \"Invalid phone number.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 20\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(Form, {\n      children: [this.state.redirectToHome ? /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/shop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 38\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-floating mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Profile Picture\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this), this.state.profilePhoto !== \"\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: `data:;base64,${this.state.profilePhoto}`,\n          alt: \"\",\n          className: \"rounded-circle mt-2 mb-3\",\n          style: {\n            objectFit: \"cover\",\n            width: \"200px\",\n            height: \"200px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this) : null, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: this.handleFileChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-floating mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"name\",\n          className: \"form-control\",\n          id: \"floatingInputUsername\",\n          placeholder: \"Enter your name\",\n          onChange: this.handleChange,\n          value: this.state.name,\n          required: true,\n          autoFocus: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this), nameError]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-floating mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Email address\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          name: \"email\",\n          className: \"form-control\",\n          id: \"floatingInputEmail\",\n          value: this.state.email,\n          placeholder: \"name@example.com\",\n          onChange: this.handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this), emailError]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \" mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Phone number \", /*#__PURE__*/_jsxDEV(\"em\", {\n            children: \"(optional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 26\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(PhoneInput, {\n          name: \"phone\",\n          country: \"ie\",\n          placeholder: \"Enter phone number\",\n          value: this.state.phone,\n          onChange: phone => this.setState({\n            phone\n          }),\n          inputStyle: {\n            fontFamily: \"'Poppins', sans-serif\",\n            fontSize: \"16px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this), phoneError]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-grid mb-2\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary fw-bold mt-4\",\n          onClick: this.handleSubmit,\n          disabled: !inputsAreAllValid,\n          children: \"Save Changes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default _c = withRouter(Profile);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/Account/Profile.jsx"],"names":["React","Form","axios","Redirect","withRouter","SERVER_HOST","Swal","PhoneInput","Profile","Component","constructor","props","handleFileChange","e","setState","selectedFile","target","files","handleChange","name","value","handleSubmit","preventDefault","defaults","withCredentials","formData","FormData","append","state","email","phone","put","match","params","id","headers","authorization","localStorage","token","then","res","data","errorMessage","console","log","fire","title","text","icon","confirmButtonColor","showConfirmButton","profilePhoto","timer","redirectToHome","componentDidMount","get","validateName","validateEmail","test","validatePhone","length","validate","render","formInputsState","inputsAreAllValid","Object","keys","every","index","nameError","emailError","phoneError","objectFit","width","height","fontFamily","fontSize"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,kBAArC;AACA,SAASC,WAAT,QAA4B,+BAA5B;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AACA,OAAO,mCAAP;;;AAEA,MAAMC,OAAN,SAAsBR,KAAK,CAACS,SAA5B,CAAsC;AACpCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAWnBC,gBAXmB,GAWCC,CAAD,IAAO;AACxB,WAAKC,QAAL,CAAc;AAAEC,QAAAA,YAAY,EAAEF,CAAC,CAACG,MAAF,CAASC,KAAT,CAAe,CAAf;AAAhB,OAAd;AACD,KAbkB;;AAAA,SA8DnBC,YA9DmB,GA8DHL,CAAD,IAAO;AACpB,WAAKC,QAAL,CAAc;AAAE,SAACD,CAAC,CAACG,MAAF,CAASG,IAAV,GAAiBN,CAAC,CAACG,MAAF,CAASI;AAA5B,OAAd;AACD,KAhEkB;;AAAA,SAkEnBC,YAlEmB,GAkEHR,CAAD,IAAO;AACpBA,MAAAA,CAAC,CAACS,cAAF;AACApB,MAAAA,KAAK,CAACqB,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AAEA,UAAIC,QAAQ,GAAG,IAAIC,QAAJ,EAAf;AACAD,MAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwB,KAAKC,KAAL,CAAWT,IAAnC;AACAM,MAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB,KAAKC,KAAL,CAAWC,KAApC;AACAJ,MAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB,KAAKC,KAAL,CAAWE,KAApC;AACAL,MAAAA,QAAQ,CAACE,MAAT,CAAgB,cAAhB,EAAgC,KAAKC,KAAL,CAAWb,YAA3C;AAEAb,MAAAA,KAAK,CACF6B,GADH,CACQ,GAAE1B,WAAY,UAAS,KAAKM,KAAL,CAAWqB,KAAX,CAAiBC,MAAjB,CAAwBC,EAAG,EAD1D,EAC6DT,QAD7D,EACuE;AACnEU,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAEC,YAAY,CAACC,KADrB;AAEP,0BAAgB;AAFT;AAD0D,OADvE,EAOGC,IAPH,CAOSC,GAAD,IAAS;AACb,YAAIA,GAAG,CAACC,IAAR,EAAc;AACZ,cAAID,GAAG,CAACC,IAAJ,CAASC,YAAb,EAA2B;AACzBC,YAAAA,OAAO,CAACC,GAAR,CAAYJ,GAAG,CAACC,IAAJ,CAASC,YAArB;AACApC,YAAAA,IAAI,CAACuC,IAAL,CAAU;AACRC,cAAAA,KAAK,EAAE,mBADC;AAERC,cAAAA,IAAI,EAAEP,GAAG,CAACC,IAAJ,CAASC,YAFP;AAGRM,cAAAA,IAAI,EAAE,OAHE;AAIRC,cAAAA,kBAAkB,EAAE,SAJZ;AAKRC,cAAAA,iBAAiB,EAAE;AALX,aAAV;AAOD,WATD,MASO;AACLP,YAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;;AACA,gBAAI,KAAKhB,KAAL,CAAWb,YAAX,KAA4B,IAAhC,EAAsC;AACpCsB,cAAAA,YAAY,CAACc,YAAb,GAA4BX,GAAG,CAACC,IAAJ,CAASU,YAArC;AACD;;AAED7C,YAAAA,IAAI,CAACuC,IAAL,CAAU;AACRC,cAAAA,KAAK,EAAE,eADC;AAERC,cAAAA,IAAI,EAAE,iCAFE;AAGRC,cAAAA,IAAI,EAAE,SAHE;AAIRE,cAAAA,iBAAiB,EAAE,KAJX;AAKRE,cAAAA,KAAK,EAAE;AALC,aAAV;AAOA,iBAAKtC,QAAL,CAAc;AAAEuC,cAAAA,cAAc,EAAE;AAAlB,aAAd;AACD;AACF,SAzBD,MAyBO;AACLV,UAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACAtC,UAAAA,IAAI,CAACuC,IAAL,CAAU;AACRC,YAAAA,KAAK,EAAE,mBADC;AAERC,YAAAA,IAAI,EAAE,+BAFE;AAGRC,YAAAA,IAAI,EAAE,OAHE;AAIRC,YAAAA,kBAAkB,EAAE,SAJZ;AAKRC,YAAAA,iBAAiB,EAAE;AALX,WAAV;AAOD;AACF,OA3CH;AA4CD,KAxHkB;;AAEjB,SAAKtB,KAAL,GAAa;AACXT,MAAAA,IAAI,EAAE,EADK;AAEXU,MAAAA,KAAK,EAAE,EAFI;AAGXC,MAAAA,KAAK,EAAE,EAHI;AAIXf,MAAAA,YAAY,EAAE,IAJH;AAKXoC,MAAAA,YAAY,EAAE;AALH,KAAb;AAOD;;AAMDG,EAAAA,iBAAiB,GAAG;AAClBpD,IAAAA,KAAK,CAACqB,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AAEAtB,IAAAA,KAAK,CACFqD,GADH,CACQ,GAAElD,WAAY,UAAS,KAAKM,KAAL,CAAWqB,KAAX,CAAiBC,MAAjB,CAAwBC,EAAG,EAD1D,EAC6D;AACzDC,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAEC,YAAY,CAACC;AAA9B;AADgD,KAD7D,EAIGC,IAJH,CAISC,GAAD,IAAS;AACb,UAAIA,GAAG,CAACC,IAAR,EAAc;AACZ,YAAID,GAAG,CAACC,IAAJ,CAASC,YAAb,EAA2B;AACzBC,UAAAA,OAAO,CAACC,GAAR,CAAYJ,GAAG,CAACC,IAAJ,CAASC,YAArB;AACD,SAFD,MAEO;AACL,eAAK5B,QAAL,CAAc;AACZK,YAAAA,IAAI,EAAEqB,GAAG,CAACC,IAAJ,CAAStB,IADH;AAEZU,YAAAA,KAAK,EAAEW,GAAG,CAACC,IAAJ,CAASZ,KAFJ;AAGZC,YAAAA,KAAK,EAAEU,GAAG,CAACC,IAAJ,CAASX,KAHJ;AAIZqB,YAAAA,YAAY,EAAEX,GAAG,CAACC,IAAJ,CAASU;AAJX,WAAd;AAMD;AACF,OAXD,MAWO;AACLR,QAAAA,OAAO,CAACC,GAAR,CAAa,mBAAb;AACD;AACF,KAnBH;AAoBD;;AAEDY,EAAAA,YAAY,GAAG;AACb,WAAO,KAAK5B,KAAL,CAAWT,IAAX,KAAoB,EAA3B;AACD;;AAEDsC,EAAAA,aAAa,GAAG;AACd,WAAO,gDAAgDC,IAAhD,CACL,KAAK9B,KAAL,CAAWC,KADN,CAAP;AAGD;;AAED8B,EAAAA,aAAa,GAAG;AACd,WAAO,KAAK/B,KAAL,CAAWE,KAAX,CAAiB8B,MAAjB,KAA4B,CAA5B,IAAiC,KAAKhC,KAAL,CAAWE,KAAX,CAAiB8B,MAAjB,IAA2B,EAAnE;AACD;;AAEDC,EAAAA,QAAQ,GAAG;AACT,WAAO;AACL1C,MAAAA,IAAI,EAAE,KAAKqC,YAAL,EADD;AAEL3B,MAAAA,KAAK,EAAE,KAAK4B,aAAL,EAFF;AAGL3B,MAAAA,KAAK,EAAE,KAAK6B,aAAL;AAHF,KAAP;AAKD;;AA8DDG,EAAAA,MAAM,GAAG;AACP,UAAMC,eAAe,GAAG,KAAKF,QAAL,EAAxB;AACA,UAAMG,iBAAiB,GAAGC,MAAM,CAACC,IAAP,CAAYH,eAAZ,EAA6BI,KAA7B,CACvBC,KAAD,IAAWL,eAAe,CAACK,KAAD,CADF,CAA1B;AAIA,QAAIC,SAAS,GAAG,EAAhB;AACA,QAAIC,UAAU,GAAG,EAAjB;AACA,QAAIC,UAAU,GAAG,EAAjB;;AAEA,QAAI,CAAC,KAAKf,YAAL,EAAL,EAA0B;AACxBa,MAAAA,SAAS,gBAAG;AAAG,QAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAZ;AACD;;AACD,QAAI,CAAC,KAAKZ,aAAL,EAAL,EAA2B;AACzBa,MAAAA,UAAU,gBAAG;AAAG,QAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAb;AACD;;AACD,QAAI,CAAC,KAAKX,aAAL,EAAL,EAA2B;AACzBY,MAAAA,UAAU,gBAAG;AAAG,QAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAb;AACD;;AAED,wBACE,QAAC,IAAD;AAAA,iBACG,KAAK3C,KAAL,CAAWyB,cAAX,gBAA4B,QAAC,QAAD;AAAU,QAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,cAA5B,GAAsD,IADzD,eAEE;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA,gCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAA;AAAA;AAAA;AAAA,gBAFF,EAGG,KAAKzB,KAAL,CAAWuB,YAAX,KAA4B,EAA5B,gBACC;AACE,UAAA,GAAG,EAAG,gBAAe,KAAKvB,KAAL,CAAWuB,YAAa,EAD/C;AAEE,UAAA,GAAG,EAAC,EAFN;AAGE,UAAA,SAAS,EAAC,0BAHZ;AAIE,UAAA,KAAK,EAAE;AAAEqB,YAAAA,SAAS,EAAE,OAAb;AAAsBC,YAAAA,KAAK,EAAE,OAA7B;AAAsCC,YAAAA,MAAM,EAAE;AAA9C;AAJT;AAAA;AAAA;AAAA;AAAA,gBADD,GAOG,IAVN,eAWE;AAAA;AAAA;AAAA;AAAA,gBAXF,eAYE;AAAO,UAAA,IAAI,EAAC,MAAZ;AAAmB,UAAA,QAAQ,EAAE,KAAK9D;AAAlC;AAAA;AAAA;AAAA;AAAA,gBAZF;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF,eAiBE;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA,gCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,IAAI,EAAC,MAFP;AAGE,UAAA,SAAS,EAAC,cAHZ;AAIE,UAAA,EAAE,EAAC,uBAJL;AAKE,UAAA,WAAW,EAAC,iBALd;AAME,UAAA,QAAQ,EAAE,KAAKM,YANjB;AAOE,UAAA,KAAK,EAAE,KAAKU,KAAL,CAAWT,IAPpB;AAQE,UAAA,QAAQ,MARV;AASE,UAAA,SAAS;AATX;AAAA;AAAA;AAAA;AAAA,gBAFF,EAaGkD,SAbH;AAAA;AAAA;AAAA;AAAA;AAAA,cAjBF,eAiCE;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA,gCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,OADP;AAEE,UAAA,IAAI,EAAC,OAFP;AAGE,UAAA,SAAS,EAAC,cAHZ;AAIE,UAAA,EAAE,EAAC,oBAJL;AAKE,UAAA,KAAK,EAAE,KAAKzC,KAAL,CAAWC,KALpB;AAME,UAAA,WAAW,EAAC,kBANd;AAOE,UAAA,QAAQ,EAAE,KAAKX;AAPjB;AAAA;AAAA;AAAA;AAAA,gBAFF,EAWGoD,UAXH;AAAA;AAAA;AAAA;AAAA;AAAA,cAjCF,eA+CE;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA,gCACE;AAAA,mDACe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADf;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAIE,QAAC,UAAD;AACE,UAAA,IAAI,EAAC,OADP;AAEE,UAAA,OAAO,EAAE,IAFX;AAGE,UAAA,WAAW,EAAC,oBAHd;AAIE,UAAA,KAAK,EAAE,KAAK1C,KAAL,CAAWE,KAJpB;AAKE,UAAA,QAAQ,EAAGA,KAAD,IAAW,KAAKhB,QAAL,CAAc;AAAEgB,YAAAA;AAAF,WAAd,CALvB;AAME,UAAA,UAAU,EAAE;AACV6C,YAAAA,UAAU,EAAE,uBADF;AAEVC,YAAAA,QAAQ,EAAE;AAFA;AANd;AAAA;AAAA;AAAA;AAAA,gBAJF,EAeGL,UAfH;AAAA;AAAA;AAAA;AAAA;AAAA,cA/CF,eAiEE;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA,+BACE;AACE,UAAA,SAAS,EAAC,8BADZ;AAEE,UAAA,OAAO,EAAE,KAAKlD,YAFhB;AAGE,UAAA,QAAQ,EAAE,CAAC2C,iBAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAjEF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AA6ED;;AA5NmC;;AA+NtC,oBAAe5D,UAAU,CAACI,OAAD,CAAzB","sourcesContent":["import React from \"react\";\nimport { Form } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { Redirect, withRouter } from \"react-router-dom\";\nimport { SERVER_HOST } from \"../../config/global_constants\";\nimport Swal from \"sweetalert2\";\nimport PhoneInput from \"react-phone-input-2\";\nimport \"react-phone-input-2/lib/style.css\";\n\nclass Profile extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: \"\",\n      email: \"\",\n      phone: \"\",\n      selectedFile: null,\n      profilePhoto: \"\",\n    };\n  }\n\n  handleFileChange = (e) => {\n    this.setState({ selectedFile: e.target.files[0] });\n  };\n\n  componentDidMount() {\n    axios.defaults.withCredentials = true;\n\n    axios\n      .get(`${SERVER_HOST}/users/${this.props.match.params.id}`, {\n        headers: { authorization: localStorage.token },\n      })\n      .then((res) => {\n        if (res.data) {\n          if (res.data.errorMessage) {\n            console.log(res.data.errorMessage);\n          } else {\n            this.setState({\n              name: res.data.name,\n              email: res.data.email,\n              phone: res.data.phone,\n              profilePhoto: res.data.profilePhoto,\n            });\n          }\n        } else {\n          console.log(`Product not found`);\n        }\n      });\n  }\n\n  validateName() {\n    return this.state.name !== \"\";\n  }\n\n  validateEmail() {\n    return /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(\n      this.state.email\n    );\n  }\n\n  validatePhone() {\n    return this.state.phone.length === 0 || this.state.phone.length >= 10;\n  }\n\n  validate() {\n    return {\n      name: this.validateName(),\n      email: this.validateEmail(),\n      phone: this.validatePhone(),\n    };\n  }\n\n  handleChange = (e) => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n    axios.defaults.withCredentials = true;\n\n    let formData = new FormData();\n    formData.append(\"name\", this.state.name);\n    formData.append(\"email\", this.state.email);\n    formData.append(\"phone\", this.state.phone);\n    formData.append(\"profilePhoto\", this.state.selectedFile);\n\n    axios\n      .put(`${SERVER_HOST}/users/${this.props.match.params.id}`, formData, {\n        headers: {\n          authorization: localStorage.token,\n          \"Content-type\": \"multipart/form-data\",\n        },\n      })\n      .then((res) => {\n        if (res.data) {\n          if (res.data.errorMessage) {\n            console.log(res.data.errorMessage);\n            Swal.fire({\n              title: \"Changes not saved\",\n              text: res.data.errorMessage,\n              icon: \"error\",\n              confirmButtonColor: \"#123c69\",\n              showConfirmButton: true,\n            });\n          } else {\n            console.log(\"Changes saved\");\n            if (this.state.selectedFile !== null) {\n              localStorage.profilePhoto = res.data.profilePhoto;\n            }\n\n            Swal.fire({\n              title: \"Changes saved\",\n              text: \"User details have been updated.\",\n              icon: \"success\",\n              showConfirmButton: false,\n              timer: 1500,\n            });\n            this.setState({ redirectToHome: true });\n          }\n        } else {\n          console.log(\"Changes not saved\");\n          Swal.fire({\n            title: \"Changes not saved\",\n            text: \"Make sure that data is valid.\",\n            icon: \"error\",\n            confirmButtonColor: \"#123c69\",\n            showConfirmButton: true,\n          });\n        }\n      });\n  };\n\n  render() {\n    const formInputsState = this.validate();\n    const inputsAreAllValid = Object.keys(formInputsState).every(\n      (index) => formInputsState[index]\n    );\n\n    let nameError = \"\";\n    let emailError = \"\";\n    let phoneError = \"\";\n\n    if (!this.validateName()) {\n      nameError = <p className=\"text-danger mt-2\">User name is required.</p>;\n    }\n    if (!this.validateEmail()) {\n      emailError = <p className=\"text-danger mt-2\">Invalid email.</p>;\n    }\n    if (!this.validatePhone()) {\n      phoneError = <p className=\"text-danger mt-2\">Invalid phone number.</p>;\n    }\n\n    return (\n      <Form>\n        {this.state.redirectToHome ? <Redirect to=\"/shop\" /> : null}\n        <div className=\"form-floating mb-3\">\n          <label>Profile Picture</label>\n          <br />\n          {this.state.profilePhoto !== \"\" ? (\n            <img\n              src={`data:;base64,${this.state.profilePhoto}`}\n              alt=\"\"\n              className=\"rounded-circle mt-2 mb-3\"\n              style={{ objectFit: \"cover\", width: \"200px\", height: \"200px\" }}\n            />\n          ) : null}\n          <br />\n          <input type=\"file\" onChange={this.handleFileChange} />\n        </div>\n\n        <div className=\"form-floating mb-3\">\n          <label>Name</label>\n          <input\n            type=\"text\"\n            name=\"name\"\n            className=\"form-control\"\n            id=\"floatingInputUsername\"\n            placeholder=\"Enter your name\"\n            onChange={this.handleChange}\n            value={this.state.name}\n            required\n            autoFocus\n          />\n          {nameError}\n        </div>\n\n        <div className=\"form-floating mb-3\">\n          <label>Email address</label>\n          <input\n            type=\"email\"\n            name=\"email\"\n            className=\"form-control\"\n            id=\"floatingInputEmail\"\n            value={this.state.email}\n            placeholder=\"name@example.com\"\n            onChange={this.handleChange}\n          />\n          {emailError}\n        </div>\n\n        <div className=\" mb-3\">\n          <label>\n            Phone number <em>(optional)</em>\n          </label>\n          <PhoneInput\n            name=\"phone\"\n            country={\"ie\"}\n            placeholder=\"Enter phone number\"\n            value={this.state.phone}\n            onChange={(phone) => this.setState({ phone })}\n            inputStyle={{\n              fontFamily: \"'Poppins', sans-serif\",\n              fontSize: \"16px\",\n            }}\n          />\n          {phoneError}\n        </div>\n\n        <div className=\"d-grid mb-2\">\n          <button\n            className=\"btn btn-primary fw-bold mt-4\"\n            onClick={this.handleSubmit}\n            disabled={!inputsAreAllValid}\n          >\n            Save Changes\n          </button>\n        </div>\n      </Form>\n    );\n  }\n}\n\nexport default withRouter(Profile);\n"]},"metadata":{},"sourceType":"module"}