{"ast":null,"code":"var _jsxFileName = \"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ShoppingCart/CartRow.jsx\";\nimport React from \"react\";\nimport { ACCESS_LEVEL_GUEST, SERVER_HOST } from \"../../config/global_constants\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport { Trash } from \"react-bootstrap-icons\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass CartRow extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleIncreaseQuantity = e => {\n      if (this.state.quantity === this.state.stock) {\n        Swal.fire({\n          title: \"Product not added\",\n          text: \"Not enough stock\",\n          icon: \"error\",\n          showConfirmButton: true,\n          confirmButtonColor: \"#123c69\"\n        });\n      } else {\n        if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n          axios.put(`${SERVER_HOST}/cart/increaseQuantity/${this.props.item._id}/${this.state._id}`).then(res => {\n            window.location.reload(false);\n          });\n        } else {\n          let curCart = JSON.parse(localStorage.cart);\n          curCart.forEach(item => {\n            if (item.productId === this.props.item.productId) {\n              item.quantity++;\n              window.location.reload(false);\n            }\n          });\n          localStorage.cart = JSON.stringify(curCart);\n        }\n      }\n    };\n\n    this.handleDecreaseQuantity = e => {\n      if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n        axios.put(`${SERVER_HOST}/cart/decreaseQuantity/${this.props.item._id}/${this.state._id}`).then(res => {\n          window.location.reload(false);\n        });\n      } else {\n        let curCart = JSON.parse(localStorage.cart);\n        curCart.forEach(item => {\n          if (item.productId === this.props.item.productId) {\n            item.quantity--;\n            window.location.reload(false);\n          }\n        });\n        localStorage.cart = JSON.stringify(curCart);\n      }\n    };\n\n    this.handleRemoveItem = e => {\n      console.log(this.state.cartId);\n      const MySwal = Swal.mixin({\n        customClass: {\n          confirmButton: \"btn btn-success mr-2\",\n          cancelButton: \"btn btn-danger ml-2\"\n        },\n        buttonsStyling: false\n      });\n      MySwal.fire({\n        title: \"Remove item from shopping cart?\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#5cb85c\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"Yes, delete it!\"\n      }).then(result => {\n        if (result.isConfirmed) {\n          alert(this.state.cartId);\n\n          if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n            axios.delete(`${SERVER_HOST}/cart/${this.state.cartId}}`).then(res => {\n              window.location.reload(false);\n            });\n          } else {\n            let index = 0;\n            let curCart = JSON.parse(localStorage.cart);\n            curCart.forEach((item, i) => {\n              if (item.productId === this.props.item.productId) {\n                index = i;\n              }\n            });\n            curCart.splice(index, 1);\n            localStorage.cart = JSON.stringify(curCart);\n            window.location.reload(false);\n          }\n        }\n      });\n    };\n\n    this.state = {\n      productName: \"\",\n      price: \"\",\n      _id: \"\",\n      quantity: this.props.item.quantity,\n      totalPrice: 0,\n      cartItem: \"\",\n      stock: 0,\n      photos: []\n    };\n  }\n\n  componentDidMount() {\n    axios.get(`${SERVER_HOST}/products/${this.props.item.productId}`).then(res => {\n      if (res.data) {\n        if (res.data.errorMessage) {\n          console.log(res.data.errorMessage);\n        } else {\n          this.setState({\n            _id: res.data._id,\n            productName: res.data.productName,\n            price: res.data.price,\n            totalPrice: res.data.price * this.state.quantity,\n            stock: res.data.stock,\n            photos: res.data.photos\n          });\n          res.data.photos.map(photo => {\n            return axios.get(`${SERVER_HOST}/products/photo/${photo.filename}`).then(res => {\n              if (res.data) {\n                if (res.data.errorMessage) {\n                  console.log(res.data.errorMessage);\n                } else {\n                  document.getElementById(photo._id).src = `data:;base64,${res.data.image}`;\n                }\n              } else {\n                console.log(\"Record not found\");\n              }\n            });\n          });\n        }\n      } else {\n        console.log(`Product not found`);\n      }\n    });\n\n    if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n      axios.get(`${SERVER_HOST}/cart/${this.props.item.productId}/${localStorage._id}`).then(res => {\n        if (res.data) {\n          this.setState({\n            cartId: res.data._id\n          });\n          this.setState({\n            quantity: res.data.quantity\n          });\n        }\n      });\n    } else {\n      JSON.parse(localStorage.cart).forEach(item => {\n        if (item.productId === this.props.item.productId) {\n          this.setState({\n            cartId: item._id\n          });\n          this.setState({\n            quantity: item.quantity\n          });\n        }\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product border-bottom mt-0 mb-2\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-3\",\n          children: this.state.photos.map((photo, index) => index === 0 ? /*#__PURE__*/_jsxDEV(\"img\", {\n            width: \"200px\",\n            className: \"rounded\",\n            id: photo._id,\n            alt: \"Product\"\n          }, photo._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 17\n          }, this) : null)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-8\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-5\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: /*#__PURE__*/_jsxDEV(\"h6\", {\n                    children: this.state.productName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 200,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 199,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-4 quantity\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Quantity:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 204,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 19\n                }, this), this.state.quantity > 1 ? /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn rounded-circle mr-3\",\n                  onClick: this.handleDecreaseQuantity,\n                  children: \"-\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 207,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn rounded-circle mr-3\",\n                  onClick: this.handleRemoveItem,\n                  children: \"-\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 214,\n                  columnNumber: 21\n                }, this), this.state.quantity, /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn rounded-circle ml-3\",\n                    onClick: this.handleIncreaseQuantity,\n                    children: \"+\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 224,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 223,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-md-3 price\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"\\u20AC\", (Math.round(this.state.totalPrice * 100) / 100).toFixed(2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Trash, {\n                  onClick: this.handleRemoveItem,\n                  className: \"ml-3 cursor-pointer\",\n                  color: \"#787878\",\n                  size: 20\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default CartRow;","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ShoppingCart/CartRow.jsx"],"names":["React","ACCESS_LEVEL_GUEST","SERVER_HOST","axios","Swal","Trash","CartRow","Component","constructor","props","handleIncreaseQuantity","e","state","quantity","stock","fire","title","text","icon","showConfirmButton","confirmButtonColor","localStorage","accessLevel","parseInt","put","item","_id","then","res","window","location","reload","curCart","JSON","parse","cart","forEach","productId","stringify","handleDecreaseQuantity","handleRemoveItem","console","log","cartId","MySwal","mixin","customClass","confirmButton","cancelButton","buttonsStyling","showCancelButton","cancelButtonColor","confirmButtonText","result","isConfirmed","alert","delete","index","i","splice","productName","price","totalPrice","cartItem","photos","componentDidMount","get","data","errorMessage","setState","map","photo","filename","document","getElementById","src","image","render","Math","round","toFixed"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { ACCESS_LEVEL_GUEST, SERVER_HOST } from \"../../config/global_constants\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport { Trash } from \"react-bootstrap-icons\";\n\nclass CartRow extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      productName: \"\",\n      price: \"\",\n      _id: \"\",\n      quantity: this.props.item.quantity,\n      totalPrice: 0,\n      cartItem: \"\",\n      stock: 0,\n      photos: [],\n    };\n  }\n\n  componentDidMount() {\n    axios\n      .get(`${SERVER_HOST}/products/${this.props.item.productId}`)\n      .then((res) => {\n        if (res.data) {\n          if (res.data.errorMessage) {\n            console.log(res.data.errorMessage);\n          } else {\n            this.setState({\n              _id: res.data._id,\n              productName: res.data.productName,\n              price: res.data.price,\n              totalPrice: res.data.price * this.state.quantity,\n              stock: res.data.stock,\n              photos: res.data.photos,\n            });\n\n            res.data.photos.map((photo) => {\n              return axios\n                .get(`${SERVER_HOST}/products/photo/${photo.filename}`)\n                .then((res) => {\n                  if (res.data) {\n                    if (res.data.errorMessage) {\n                      console.log(res.data.errorMessage);\n                    } else {\n                      document.getElementById(\n                        photo._id\n                      ).src = `data:;base64,${res.data.image}`;\n                    }\n                  } else {\n                    console.log(\"Record not found\");\n                  }\n                });\n            });\n          }\n        } else {\n          console.log(`Product not found`);\n        }\n      });\n\n    if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n      axios\n        .get(\n          `${SERVER_HOST}/cart/${this.props.item.productId}/${localStorage._id}`\n        )\n        .then((res) => {\n          if (res.data) {\n            this.setState({ cartId: res.data._id });\n            this.setState({ quantity: res.data.quantity });\n          }\n        });\n    } else {\n      JSON.parse(localStorage.cart).forEach((item) => {\n        if (item.productId === this.props.item.productId) {\n          this.setState({ cartId: item._id });\n          this.setState({ quantity: item.quantity });\n        }\n      });\n    }\n  }\n\n  handleIncreaseQuantity = (e) => {\n    if (this.state.quantity === this.state.stock) {\n      Swal.fire({\n        title: \"Product not added\",\n        text: \"Not enough stock\",\n        icon: \"error\",\n        showConfirmButton: true,\n        confirmButtonColor: \"#123c69\",\n      });\n    } else {\n      if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n        axios\n          .put(\n            `${SERVER_HOST}/cart/increaseQuantity/${this.props.item._id}/${this.state._id}`\n          )\n          .then((res) => {\n            window.location.reload(false);\n          });\n      } else {\n        let curCart = JSON.parse(localStorage.cart);\n        curCart.forEach((item) => {\n          if (item.productId === this.props.item.productId) {\n            item.quantity++;\n            window.location.reload(false);\n          }\n        });\n\n        localStorage.cart = JSON.stringify(curCart);\n      }\n    }\n  };\n\n  handleDecreaseQuantity = (e) => {\n    if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n      axios\n        .put(\n          `${SERVER_HOST}/cart/decreaseQuantity/${this.props.item._id}/${this.state._id}`\n        )\n        .then((res) => {\n          window.location.reload(false);\n        });\n    } else {\n      let curCart = JSON.parse(localStorage.cart);\n      curCart.forEach((item) => {\n        if (item.productId === this.props.item.productId) {\n          item.quantity--;\n          window.location.reload(false);\n        }\n      });\n      localStorage.cart = JSON.stringify(curCart);\n    }\n  };\n\n  handleRemoveItem = (e) => {\n    console.log(this.state.cartId);\n    const MySwal = Swal.mixin({\n      customClass: {\n        confirmButton: \"btn btn-success mr-2\",\n        cancelButton: \"btn btn-danger ml-2\",\n      },\n      buttonsStyling: false,\n    });\n\n    MySwal.fire({\n      title: \"Remove item from shopping cart?\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonColor: \"#5cb85c\",\n      cancelButtonColor: \"#d33\",\n      confirmButtonText: \"Yes, delete it!\",\n    }).then((result) => {\n      if (result.isConfirmed) {\n        alert(this.state.cartId);\n        if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n          axios\n            .delete(`${SERVER_HOST}/cart/${this.state.cartId}}`)\n            .then((res) => {\n              window.location.reload(false);\n            });\n        } else {\n          let index = 0;\n          let curCart = JSON.parse(localStorage.cart);\n          curCart.forEach((item, i) => {\n            if (item.productId === this.props.item.productId) {\n              index = i;\n            }\n          });\n          curCart.splice(index, 1);\n          localStorage.cart = JSON.stringify(curCart);\n          window.location.reload(false);\n        }\n      }\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"product border-bottom mt-0 mb-2\">\n        <div className=\"row\">\n          <div className=\"col-md-3\">\n            {this.state.photos.map((photo, index) =>\n              index === 0 ? (\n                <img\n                  width=\"200px\"\n                  className=\"rounded\"\n                  key={photo._id}\n                  id={photo._id}\n                  alt=\"Product\"\n                />\n              ) : null\n            )}\n          </div>\n          <div className=\"col-md-8\">\n            <div className=\"info\">\n              <div className=\"row\">\n                <div className=\"col-md-5\">\n                  <div>\n                    <h6>{this.state.productName}</h6>\n                  </div>\n                </div>\n                <div className=\"col-md-4 quantity\">\n                  <label>Quantity:</label>\n                  <br />\n                  {this.state.quantity > 1 ? (\n                    <button\n                      className=\"btn rounded-circle mr-3\"\n                      onClick={this.handleDecreaseQuantity}\n                    >\n                      -\n                    </button>\n                  ) : (\n                    <button\n                      className=\"btn rounded-circle mr-3\"\n                      onClick={this.handleRemoveItem}\n                    >\n                      -\n                    </button>\n                  )}\n                  {this.state.quantity}\n\n                  <span className=\"\">\n                    <button\n                      className=\"btn rounded-circle ml-3\"\n                      onClick={this.handleIncreaseQuantity}\n                    >\n                      +\n                    </button>\n                  </span>\n                </div>\n                <div className=\"col-md-3 price\">\n                  <span>\n                    €\n                    {(Math.round(this.state.totalPrice * 100) / 100).toFixed(2)}\n                  </span>\n                  <Trash\n                    onClick={this.handleRemoveItem}\n                    className=\"ml-3 cursor-pointer\"\n                    color=\"#787878\"\n                    size={20}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default CartRow;\n"]},"metadata":{},"sourceType":"module"}