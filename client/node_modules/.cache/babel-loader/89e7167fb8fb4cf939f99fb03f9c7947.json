{"ast":null,"code":"var _jsxFileName = \"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/Purchases/OrderReturn.jsx\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport { SERVER_HOST } from \"../../config/global_constants\";\nimport ShopBanner from \"../ShopBanner\";\nimport OrderDetailsRow from \"./OrderDetailsRow\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport Swal from \"sweetalert2\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass OrderReturn extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleSelected = e => {\n      let selected = this.state.selected;\n      let index;\n\n      if (e.target.checked) {\n        selected.push(e.target.value);\n        let productObj = JSON.parse(e.target.value);\n        axios.get(`${SERVER_HOST}/products/${productObj.productId}`).then(res => {\n          this.setState({\n            returnTotal: parseInt(this.state.returnTotal) + productObj.quantity * res.data.price\n          });\n        });\n      } else {\n        index = selected.indexOf(e.target.value);\n        selected.splice(index, 1);\n        let productObj = JSON.parse(e.target.value);\n        axios.get(`${SERVER_HOST}/products/${productObj.productId}`).then(res => {\n          this.setState({\n            returnTotal: parseInt(this.state.returnTotal) - productObj.quantity * res.data.price\n          });\n        });\n      }\n\n      this.setState({\n        selected: selected\n      });\n\n      if (this.state.selected.length === 0) {\n        this.setState({\n          returnTotal: 0\n        });\n      }\n    };\n\n    this.handleSubmit = e => {\n      axios.defaults.withCredentials = true;\n      let today = new Date();\n      let returnObj = {\n        orderId: this.props.match.params.id,\n        products: this.state.selected,\n        userId: localStorage._id,\n        date: today\n      };\n      axios.post(`${SERVER_HOST}/return`, returnObj);\n      Swal.fire({\n        title: \"Product return confirmed\",\n        text: \"Your return is being processed.\",\n        icon: \"success\",\n        showConfirmButton: false,\n        timer: 1500\n      });\n      this.setState({\n        redirect: true\n      });\n    };\n\n    this.state = {\n      products: [],\n      user: \"\",\n      photos: [],\n      quantity: [],\n      selected: [],\n      _id: \"\",\n      redirect: false,\n      returnTotal: 0\n    };\n  }\n\n  componentDidMount() {\n    axios.defaults.withCredentials = true;\n    axios.get(`${SERVER_HOST}/orders/${this.props.match.params.id}`, {\n      headers: {\n        authorization: localStorage.token\n      }\n    }).then(res => {\n      this.setState({\n        _id: res.data._id\n      });\n      let products = [];\n      res.data.products.map((product, index) => {\n        products[index] = product;\n        this.setState({\n          products: products\n        });\n      });\n\n      if (res.data.userId !== \"undefined\") {\n        axios.get(`${SERVER_HOST}/users/${res.data.userId}`, {\n          headers: {\n            authorization: localStorage.token\n          }\n        }).then(res => {\n          this.setState({\n            user: res.data.email\n          });\n        });\n      } else {\n        this.setState({\n          user: \"guest\"\n        });\n      }\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex flex-column align-items-center\",\n      children: [this.state.redirect ? /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/shop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 32\n      }, this) : null, /*#__PURE__*/_jsxDEV(ShopBanner, {\n        title: \"Order Return\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"hgvcfwqx container p-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-center mb-4\",\n          children: \"Select items to return\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), this.state.products.map(product => product.status !== \"Returned\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex align-items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            onChange: this.handleSelected,\n            type: \"checkbox\",\n            value: JSON.stringify({\n              productId: product.productId,\n              quantity: product.quantity,\n              _id: product._id\n            }),\n            className: \"mr-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(OrderDetailsRow, {\n            product: product\n          }, product._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 15\n        }, this) : null)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-light p-3 order-details-summary mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-center mb-4\",\n          children: \"Summary\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Refund method: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"float-right\",\n            children: /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Paypal\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Shipping cost: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"float-right\",\n            children: \"FREE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-item mt-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Refund total: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"float-right\",\n            children: [\"\\u20AC\", this.state.returnTotal]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex flex-row m-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.handleSubmit,\n          className: \"btn btn-success mr-3 mb-4 w-80\",\n          disabled: this.state.selected.length === 0,\n          children: \"Confirm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: {\n            pathname: `/orders/${this.props.match.params.id}`,\n            state: {\n              order: this.props.location.state.order\n            }\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-danger ml-3 mb-4 w-80\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default OrderReturn;","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/Purchases/OrderReturn.jsx"],"names":["React","axios","SERVER_HOST","ShopBanner","OrderDetailsRow","Link","Redirect","Swal","OrderReturn","Component","constructor","props","handleSelected","e","selected","state","index","target","checked","push","value","productObj","JSON","parse","get","productId","then","res","setState","returnTotal","parseInt","quantity","data","price","indexOf","splice","length","handleSubmit","defaults","withCredentials","today","Date","returnObj","orderId","match","params","id","products","userId","localStorage","_id","date","post","fire","title","text","icon","showConfirmButton","timer","redirect","user","photos","componentDidMount","headers","authorization","token","map","product","email","render","status","stringify","pathname","order","location"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,+BAA5B;AACA,OAAOC,UAAP,MAAuB,eAAvB;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,SAASC,IAAT,EAAeC,QAAf,QAA+B,kBAA/B;AACA,OAAOC,IAAP,MAAiB,aAAjB;;;AAEA,MAAMC,WAAN,SAA0BR,KAAK,CAACS,SAAhC,CAA0C;AACxCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAcnBC,cAdmB,GAcDC,CAAD,IAAO;AACtB,UAAIC,QAAQ,GAAG,KAAKC,KAAL,CAAWD,QAA1B;AACA,UAAIE,KAAJ;;AACA,UAAIH,CAAC,CAACI,MAAF,CAASC,OAAb,EAAsB;AACpBJ,QAAAA,QAAQ,CAACK,IAAT,CAAcN,CAAC,CAACI,MAAF,CAASG,KAAvB;AAEA,YAAIC,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWV,CAAC,CAACI,MAAF,CAASG,KAApB,CAAjB;AACAnB,QAAAA,KAAK,CACFuB,GADH,CACQ,GAAEtB,WAAY,aAAYmB,UAAU,CAACI,SAAU,EADvD,EAEGC,IAFH,CAESC,GAAD,IAAS;AACb,eAAKC,QAAL,CAAc;AACZC,YAAAA,WAAW,EACTC,QAAQ,CAAC,KAAKf,KAAL,CAAWc,WAAZ,CAAR,GACAR,UAAU,CAACU,QAAX,GAAsBJ,GAAG,CAACK,IAAJ,CAASC;AAHrB,WAAd;AAKD,SARH;AASD,OAbD,MAaO;AACLjB,QAAAA,KAAK,GAAGF,QAAQ,CAACoB,OAAT,CAAiBrB,CAAC,CAACI,MAAF,CAASG,KAA1B,CAAR;AACAN,QAAAA,QAAQ,CAACqB,MAAT,CAAgBnB,KAAhB,EAAuB,CAAvB;AAEA,YAAIK,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWV,CAAC,CAACI,MAAF,CAASG,KAApB,CAAjB;AACAnB,QAAAA,KAAK,CACFuB,GADH,CACQ,GAAEtB,WAAY,aAAYmB,UAAU,CAACI,SAAU,EADvD,EAEGC,IAFH,CAESC,GAAD,IAAS;AACb,eAAKC,QAAL,CAAc;AACZC,YAAAA,WAAW,EACTC,QAAQ,CAAC,KAAKf,KAAL,CAAWc,WAAZ,CAAR,GACAR,UAAU,CAACU,QAAX,GAAsBJ,GAAG,CAACK,IAAJ,CAASC;AAHrB,WAAd;AAKD,SARH;AASD;;AACD,WAAKL,QAAL,CAAc;AAAEd,QAAAA,QAAQ,EAAEA;AAAZ,OAAd;;AAEA,UAAI,KAAKC,KAAL,CAAWD,QAAX,CAAoBsB,MAApB,KAA+B,CAAnC,EAAsC;AACpC,aAAKR,QAAL,CAAc;AAAEC,UAAAA,WAAW,EAAE;AAAf,SAAd;AACD;AACF,KAlDkB;;AAAA,SAoDnBQ,YApDmB,GAoDHxB,CAAD,IAAO;AACpBZ,MAAAA,KAAK,CAACqC,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AACA,UAAIC,KAAK,GAAG,IAAIC,IAAJ,EAAZ;AAEA,UAAIC,SAAS,GAAG;AACdC,QAAAA,OAAO,EAAE,KAAKhC,KAAL,CAAWiC,KAAX,CAAiBC,MAAjB,CAAwBC,EADnB;AAEdC,QAAAA,QAAQ,EAAE,KAAKhC,KAAL,CAAWD,QAFP;AAGdkC,QAAAA,MAAM,EAAEC,YAAY,CAACC,GAHP;AAIdC,QAAAA,IAAI,EAAEX;AAJQ,OAAhB;AAOAvC,MAAAA,KAAK,CAACmD,IAAN,CAAY,GAAElD,WAAY,SAA1B,EAAoCwC,SAApC;AACAnC,MAAAA,IAAI,CAAC8C,IAAL,CAAU;AACRC,QAAAA,KAAK,EAAE,0BADC;AAERC,QAAAA,IAAI,EAAE,iCAFE;AAGRC,QAAAA,IAAI,EAAE,SAHE;AAIRC,QAAAA,iBAAiB,EAAE,KAJX;AAKRC,QAAAA,KAAK,EAAE;AALC,OAAV;AAOA,WAAK9B,QAAL,CAAc;AAAE+B,QAAAA,QAAQ,EAAE;AAAZ,OAAd;AACD,KAxEkB;;AAEjB,SAAK5C,KAAL,GAAa;AACXgC,MAAAA,QAAQ,EAAE,EADC;AAEXa,MAAAA,IAAI,EAAE,EAFK;AAGXC,MAAAA,MAAM,EAAE,EAHG;AAIX9B,MAAAA,QAAQ,EAAE,EAJC;AAKXjB,MAAAA,QAAQ,EAAE,EALC;AAMXoC,MAAAA,GAAG,EAAE,EANM;AAOXS,MAAAA,QAAQ,EAAE,KAPC;AAQX9B,MAAAA,WAAW,EAAE;AARF,KAAb;AAUD;;AA8DDiC,EAAAA,iBAAiB,GAAG;AAClB7D,IAAAA,KAAK,CAACqC,QAAN,CAAeC,eAAf,GAAiC,IAAjC;AAEAtC,IAAAA,KAAK,CACFuB,GADH,CACQ,GAAEtB,WAAY,WAAU,KAAKS,KAAL,CAAWiC,KAAX,CAAiBC,MAAjB,CAAwBC,EAAG,EAD3D,EAC8D;AAC1DiB,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAEf,YAAY,CAACgB;AAA9B;AADiD,KAD9D,EAIGvC,IAJH,CAISC,GAAD,IAAS;AACb,WAAKC,QAAL,CAAc;AAAEsB,QAAAA,GAAG,EAAEvB,GAAG,CAACK,IAAJ,CAASkB;AAAhB,OAAd;AACA,UAAIH,QAAQ,GAAG,EAAf;AACApB,MAAAA,GAAG,CAACK,IAAJ,CAASe,QAAT,CAAkBmB,GAAlB,CAAsB,CAACC,OAAD,EAAUnD,KAAV,KAAoB;AACxC+B,QAAAA,QAAQ,CAAC/B,KAAD,CAAR,GAAkBmD,OAAlB;AACA,aAAKvC,QAAL,CAAc;AAAEmB,UAAAA,QAAQ,EAAEA;AAAZ,SAAd;AACD,OAHD;;AAKA,UAAIpB,GAAG,CAACK,IAAJ,CAASgB,MAAT,KAAoB,WAAxB,EAAqC;AACnC/C,QAAAA,KAAK,CACFuB,GADH,CACQ,GAAEtB,WAAY,UAASyB,GAAG,CAACK,IAAJ,CAASgB,MAAO,EAD/C,EACkD;AAC9Ce,UAAAA,OAAO,EAAE;AAAEC,YAAAA,aAAa,EAAEf,YAAY,CAACgB;AAA9B;AADqC,SADlD,EAIGvC,IAJH,CAISC,GAAD,IAAS;AACb,eAAKC,QAAL,CAAc;AAAEgC,YAAAA,IAAI,EAAEjC,GAAG,CAACK,IAAJ,CAASoC;AAAjB,WAAd;AACD,SANH;AAOD,OARD,MAQO;AACL,aAAKxC,QAAL,CAAc;AAAEgC,UAAAA,IAAI,EAAE;AAAR,SAAd;AACD;AACF,KAvBH;AAwBD;;AAEDS,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAC,uCAAf;AAAA,iBACG,KAAKtD,KAAL,CAAW4C,QAAX,gBAAsB,QAAC,QAAD;AAAU,QAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,cAAtB,GAAgD,IADnD,eAEE,QAAC,UAAD;AAAY,QAAA,KAAK,EAAC;AAAlB;AAAA;AAAA;AAAA;AAAA,cAFF,eAGE;AAAK,QAAA,SAAS,EAAC,wBAAf;AAAA,gCACE;AAAI,UAAA,SAAS,EAAC,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,EAEG,KAAK5C,KAAL,CAAWgC,QAAX,CAAoBmB,GAApB,CAAyBC,OAAD,IACvBA,OAAO,CAACG,MAAR,KAAmB,UAAnB,gBACE;AAAK,UAAA,SAAS,EAAC,2BAAf;AAAA,kCACE;AACE,YAAA,QAAQ,EAAE,KAAK1D,cADjB;AAEE,YAAA,IAAI,EAAC,UAFP;AAGE,YAAA,KAAK,EAAEU,IAAI,CAACiD,SAAL,CAAe;AACpB9C,cAAAA,SAAS,EAAE0C,OAAO,CAAC1C,SADC;AAEpBM,cAAAA,QAAQ,EAAEoC,OAAO,CAACpC,QAFE;AAGpBmB,cAAAA,GAAG,EAAEiB,OAAO,CAACjB;AAHO,aAAf,CAHT;AAQE,YAAA,SAAS,EAAC;AARZ;AAAA;AAAA;AAAA;AAAA,kBADF,eAWE,QAAC,eAAD;AAAmC,YAAA,OAAO,EAAEiB;AAA5C,aAAsBA,OAAO,CAACjB,GAA9B;AAAA;AAAA;AAAA;AAAA,kBAXF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,GAcI,IAfL,CAFH;AAAA;AAAA;AAAA;AAAA;AAAA,cAHF,eAwBE;AAAK,QAAA,SAAS,EAAC,yCAAf;AAAA,gCACE;AAAI,UAAA,SAAS,EAAC,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAK,UAAA,SAAS,EAAC,cAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAM,YAAA,SAAS,EAAC,aAAhB;AAAA,mCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,eAQE;AAAK,UAAA,SAAS,EAAC,cAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAM,YAAA,SAAS,EAAC,aAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBARF,eAYE;AAAK,UAAA,SAAS,EAAC,mBAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAM,YAAA,SAAS,EAAC,aAAhB;AAAA,iCAAgC,KAAKnC,KAAL,CAAWc,WAA3C;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAZF;AAAA;AAAA;AAAA;AAAA;AAAA,cAxBF,eAyCE;AAAK,QAAA,SAAS,EAAC,qBAAf;AAAA,gCACE;AACE,UAAA,OAAO,EAAE,KAAKQ,YADhB;AAEE,UAAA,SAAS,EAAC,gCAFZ;AAGE,UAAA,QAAQ,EAAE,KAAKtB,KAAL,CAAWD,QAAX,CAAoBsB,MAApB,KAA+B,CAH3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAQE,QAAC,IAAD;AACE,UAAA,EAAE,EAAE;AACFoC,YAAAA,QAAQ,EAAG,WAAU,KAAK7D,KAAL,CAAWiC,KAAX,CAAiBC,MAAjB,CAAwBC,EAAG,EAD9C;AAEF/B,YAAAA,KAAK,EAAE;AACL0D,cAAAA,KAAK,EAAE,KAAK9D,KAAL,CAAW+D,QAAX,CAAoB3D,KAApB,CAA0B0D;AAD5B;AAFL,WADN;AAAA,iCAQE;AAAQ,YAAA,SAAS,EAAC,+BAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AARF;AAAA;AAAA;AAAA;AAAA,gBARF;AAAA;AAAA;AAAA;AAAA;AAAA,cAzCF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AA+DD;;AAxKuC;;AA2K1C,eAAejE,WAAf","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport { SERVER_HOST } from \"../../config/global_constants\";\nimport ShopBanner from \"../ShopBanner\";\nimport OrderDetailsRow from \"./OrderDetailsRow\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport Swal from \"sweetalert2\";\n\nclass OrderReturn extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      products: [],\n      user: \"\",\n      photos: [],\n      quantity: [],\n      selected: [],\n      _id: \"\",\n      redirect: false,\n      returnTotal: 0,\n    };\n  }\n\n  handleSelected = (e) => {\n    let selected = this.state.selected;\n    let index;\n    if (e.target.checked) {\n      selected.push(e.target.value);\n\n      let productObj = JSON.parse(e.target.value);\n      axios\n        .get(`${SERVER_HOST}/products/${productObj.productId}`)\n        .then((res) => {\n          this.setState({\n            returnTotal:\n              parseInt(this.state.returnTotal) +\n              productObj.quantity * res.data.price,\n          });\n        });\n    } else {\n      index = selected.indexOf(e.target.value);\n      selected.splice(index, 1);\n\n      let productObj = JSON.parse(e.target.value);\n      axios\n        .get(`${SERVER_HOST}/products/${productObj.productId}`)\n        .then((res) => {\n          this.setState({\n            returnTotal:\n              parseInt(this.state.returnTotal) -\n              productObj.quantity * res.data.price,\n          });\n        });\n    }\n    this.setState({ selected: selected });\n\n    if (this.state.selected.length === 0) {\n      this.setState({ returnTotal: 0 });\n    }\n  };\n\n  handleSubmit = (e) => {\n    axios.defaults.withCredentials = true;\n    let today = new Date();\n\n    let returnObj = {\n      orderId: this.props.match.params.id,\n      products: this.state.selected,\n      userId: localStorage._id,\n      date: today,\n    };\n\n    axios.post(`${SERVER_HOST}/return`, returnObj);\n    Swal.fire({\n      title: \"Product return confirmed\",\n      text: \"Your return is being processed.\",\n      icon: \"success\",\n      showConfirmButton: false,\n      timer: 1500,\n    });\n    this.setState({ redirect: true });\n  };\n\n  componentDidMount() {\n    axios.defaults.withCredentials = true;\n\n    axios\n      .get(`${SERVER_HOST}/orders/${this.props.match.params.id}`, {\n        headers: { authorization: localStorage.token },\n      })\n      .then((res) => {\n        this.setState({ _id: res.data._id });\n        let products = [];\n        res.data.products.map((product, index) => {\n          products[index] = product;\n          this.setState({ products: products });\n        });\n\n        if (res.data.userId !== \"undefined\") {\n          axios\n            .get(`${SERVER_HOST}/users/${res.data.userId}`, {\n              headers: { authorization: localStorage.token },\n            })\n            .then((res) => {\n              this.setState({ user: res.data.email });\n            });\n        } else {\n          this.setState({ user: \"guest\" });\n        }\n      });\n  }\n\n  render() {\n    return (\n      <div className=\"d-flex flex-column align-items-center\">\n        {this.state.redirect ? <Redirect to=\"/shop\" /> : null}\n        <ShopBanner title=\"Order Return\" />\n        <div className=\"hgvcfwqx container p-3\">\n          <h4 className=\"text-center mb-4\">Select items to return</h4>\n          {this.state.products.map((product) =>\n            product.status !== \"Returned\" ? (\n              <div className=\"d-flex align-items-center\">\n                <input\n                  onChange={this.handleSelected}\n                  type=\"checkbox\"\n                  value={JSON.stringify({\n                    productId: product.productId,\n                    quantity: product.quantity,\n                    _id: product._id,\n                  })}\n                  className=\"mr-4\"\n                />\n                <OrderDetailsRow key={product._id} product={product} />\n              </div>\n            ) : null\n          )}\n        </div>\n\n        <div className=\"bg-light p-3 order-details-summary mb-4\">\n          <h4 className=\"text-center mb-4\">Summary</h4>\n          <div className=\"summary-item\">\n            <span>Refund method: </span>\n            <span className=\"float-right\">\n              <strong>Paypal</strong>\n            </span>\n          </div>\n          <div className=\"summary-item\">\n            <span>Shipping cost: </span>\n            <span className=\"float-right\">FREE</span>\n          </div>\n          <div className=\"summary-item mt-3\">\n            <span>Refund total: </span>\n            <span className=\"float-right\">€{this.state.returnTotal}</span>\n          </div>\n        </div>\n        <div className=\"d-flex flex-row m-3\">\n          <button\n            onClick={this.handleSubmit}\n            className=\"btn btn-success mr-3 mb-4 w-80\"\n            disabled={this.state.selected.length === 0}\n          >\n            Confirm\n          </button>\n          <Link\n            to={{\n              pathname: `/orders/${this.props.match.params.id}`,\n              state: {\n                order: this.props.location.state.order,\n              },\n            }}\n          >\n            <button className=\"btn btn-danger ml-3 mb-4 w-80\">Cancel</button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default OrderReturn;\n"]},"metadata":{},"sourceType":"module"}