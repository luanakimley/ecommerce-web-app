{"ast":null,"code":"import _defineProperty from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _classCallCheck from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import{Form}from\"react-bootstrap\";import axios from\"axios\";import{Redirect,withRouter}from\"react-router-dom\";import{SERVER_HOST}from\"../../config/global_constants\";import Swal from\"sweetalert2\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Password=/*#__PURE__*/function(_React$Component){_inherits(Password,_React$Component);var _super=_createSuper(Password);function Password(props){var _this;_classCallCheck(this,Password);_this=_super.call(this,props);_this.handleChange=function(e){_this.setState(_defineProperty({},e.target.name,e.target.value));};_this.handleSubmit=function(e){e.preventDefault();axios.defaults.withCredentials=true;var passwordObject={password:_this.state.newPassword};axios.put(\"\".concat(SERVER_HOST,\"/users/\").concat(_this.props.match.params.id,\"/\").concat(_this.state.oldPassword),passwordObject,{headers:{authorization:localStorage.token}}).then(function(res){console.log(\"Password changed\");Swal.fire({title:\"Password changed\",text:\"Password has been changed.\",icon:\"success\",showConfirmButton:false,timer:1500});_this.setState({redirectToHome:true});}).catch(function(err){console.log(\"Password not changed\");Swal.fire({title:\"Password not changed\",text:err.response.data,icon:\"error\",confirmButtonColor:\"#123c69\",showConfirmButton:true});});};_this.state={oldPassword:\"\",newPassword:\"\",confirmNewPassword:\"\"};return _this;}_createClass(Password,[{key:\"validatePassword\",value:function validatePassword(){return /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[£!#€$%^&*]).{8,}$/.test(this.state.newPassword);}},{key:\"validateConfirmPassword\",value:function validateConfirmPassword(){return this.state.confirmNewPassword===this.state.newPassword;}},{key:\"validate\",value:function validate(){return{password:this.validatePassword(),confirmPassword:this.validateConfirmPassword()};}},{key:\"render\",value:function render(){var formInputsState=this.validate();var inputsAreAllValid=Object.keys(formInputsState).every(function(index){return formInputsState[index];});var passwordError=\"\";var confirmPasswordError=\"\";if(!this.validatePassword()){var errorData=[];if(this.state.newPassword.length<8){errorData.push({id:0,message:\"Password must be at least 8 characters long.\"});}if(!this.state.newPassword.match(/(?=.*[0-9])/)){errorData.push({id:1,message:\"Password must contain at least one digit (0-9).\"});}if(!this.state.newPassword.match(/[a-z]+/)){errorData.push({id:2,message:\"Password must contain at least one lowercase character.\"});}if(!this.state.newPassword.match(/[A-Z]+/)){errorData.push({id:3,message:\"Password must contain at least one uppercase character.\"});}if(!this.state.newPassword.match(/(?=.*[£!#€$%^&*])/)){errorData.push({id:4,message:\"Password must contain at least one of the characters £!#€$%^&*\"});}passwordError=/*#__PURE__*/_jsx(\"ul\",{className:\"text-danger mt-2\",children:errorData.map(function(e){return/*#__PURE__*/_jsx(\"li\",{className:\"error\",children:e.message},e.id);})});}if(!this.validateConfirmPassword()){confirmPasswordError=/*#__PURE__*/_jsx(\"p\",{className:\"text-danger mt-2\",children:\"Passwords must match.\"});}return/*#__PURE__*/_jsxs(Form,{children:[this.state.redirectToHome?/*#__PURE__*/_jsx(Redirect,{to:\"/shop\"}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Current password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"oldPassword\",className:\"form-control\",placeholder:\"Enter current password\",onChange:this.handleChange,value:this.state.oldPassword,required:true,autoFocus:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"New password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"newPassword\",className:\"form-control\",placeholder:\"Enter new password\",onChange:this.handleChange,value:this.state.newPassword}),passwordError]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Confirm new password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"confirmNewPassword\",className:\"form-control\",value:this.state.confirmNewPassword,placeholder:\"Confirm new password\",onChange:this.handleChange}),confirmPasswordError]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-grid mb-2\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary fw-bold mt-4\",onClick:this.handleSubmit,disabled:!inputsAreAllValid,children:\"Change Password\"})})]});}}]);return Password;}(React.Component);export default withRouter(Password);","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/Account/Password.jsx"],"names":["React","Form","axios","Redirect","withRouter","SERVER_HOST","Swal","Password","props","handleChange","e","setState","target","name","value","handleSubmit","preventDefault","defaults","withCredentials","passwordObject","password","state","newPassword","put","match","params","id","oldPassword","headers","authorization","localStorage","token","then","res","console","log","fire","title","text","icon","showConfirmButton","timer","redirectToHome","catch","err","response","data","confirmButtonColor","confirmNewPassword","test","validatePassword","confirmPassword","validateConfirmPassword","formInputsState","validate","inputsAreAllValid","Object","keys","every","index","passwordError","confirmPasswordError","errorData","length","push","message","map","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Form } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { Redirect, withRouter } from \"react-router-dom\";\nimport { SERVER_HOST } from \"../../config/global_constants\";\nimport Swal from \"sweetalert2\";\n\nclass Password extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      oldPassword: \"\",\n      newPassword: \"\",\n      confirmNewPassword: \"\",\n    };\n  }\n\n  validatePassword() {\n    return /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[£!#€$%^&*]).{8,}$/.test(\n      this.state.newPassword\n    );\n  }\n\n  validateConfirmPassword() {\n    return this.state.confirmNewPassword === this.state.newPassword;\n  }\n\n  validate() {\n    return {\n      password: this.validatePassword(),\n      confirmPassword: this.validateConfirmPassword(),\n    };\n  }\n\n  handleChange = (e) => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n\n    axios.defaults.withCredentials = true;\n\n    const passwordObject = {\n      password: this.state.newPassword,\n    };\n\n    axios\n      .put(\n        `${SERVER_HOST}/users/${this.props.match.params.id}/${this.state.oldPassword}`,\n        passwordObject,\n        { headers: { authorization: localStorage.token } }\n      )\n      .then((res) => {\n        console.log(\"Password changed\");\n        Swal.fire({\n          title: \"Password changed\",\n          text: \"Password has been changed.\",\n          icon: \"success\",\n          showConfirmButton: false,\n          timer: 1500,\n        });\n        this.setState({ redirectToHome: true });\n      })\n      .catch((err) => {\n        console.log(\"Password not changed\");\n        Swal.fire({\n          title: \"Password not changed\",\n          text: err.response.data,\n          icon: \"error\",\n          confirmButtonColor: \"#123c69\",\n          showConfirmButton: true,\n        });\n      });\n  };\n\n  render() {\n    const formInputsState = this.validate();\n    const inputsAreAllValid = Object.keys(formInputsState).every(\n      (index) => formInputsState[index]\n    );\n\n    let passwordError = \"\";\n    let confirmPasswordError = \"\";\n\n    if (!this.validatePassword()) {\n      let errorData = [];\n\n      if (this.state.newPassword.length < 8) {\n        errorData.push({\n          id: 0,\n          message: \"Password must be at least 8 characters long.\",\n        });\n      }\n      if (!this.state.newPassword.match(/(?=.*[0-9])/)) {\n        errorData.push({\n          id: 1,\n          message: \"Password must contain at least one digit (0-9).\",\n        });\n      }\n      if (!this.state.newPassword.match(/[a-z]+/)) {\n        errorData.push({\n          id: 2,\n          message: \"Password must contain at least one lowercase character.\",\n        });\n      }\n      if (!this.state.newPassword.match(/[A-Z]+/)) {\n        errorData.push({\n          id: 3,\n          message: \"Password must contain at least one uppercase character.\",\n        });\n      }\n      if (!this.state.newPassword.match(/(?=.*[£!#€$%^&*])/)) {\n        errorData.push({\n          id: 4,\n          message:\n            \"Password must contain at least one of the characters £!#€$%^&*\",\n        });\n      }\n\n      passwordError = (\n        <ul className=\"text-danger mt-2\">\n          {errorData.map((e) => (\n            <li key={e.id} className=\"error\">\n              {e.message}\n            </li>\n          ))}\n        </ul>\n      );\n    }\n    if (!this.validateConfirmPassword()) {\n      confirmPasswordError = (\n        <p className=\"text-danger mt-2\">Passwords must match.</p>\n      );\n    }\n\n    return (\n      <Form>\n        {this.state.redirectToHome ? <Redirect to=\"/shop\" /> : null}\n        <div className=\"form-floating mb-3\">\n          <label>Current password</label>\n          <input\n            type=\"password\"\n            name=\"oldPassword\"\n            className=\"form-control\"\n            placeholder=\"Enter current password\"\n            onChange={this.handleChange}\n            value={this.state.oldPassword}\n            required\n            autoFocus\n          />\n        </div>\n\n        <div className=\"form-floating mb-3\">\n          <label>New password</label>\n          <input\n            type=\"password\"\n            name=\"newPassword\"\n            className=\"form-control\"\n            placeholder=\"Enter new password\"\n            onChange={this.handleChange}\n            value={this.state.newPassword}\n          />\n          {passwordError}\n        </div>\n\n        <div className=\"form-floating mb-3\">\n          <label>Confirm new password</label>\n          <input\n            type=\"password\"\n            name=\"confirmNewPassword\"\n            className=\"form-control\"\n            value={this.state.confirmNewPassword}\n            placeholder=\"Confirm new password\"\n            onChange={this.handleChange}\n          />\n          {confirmPasswordError}\n        </div>\n        <div className=\"d-grid mb-2\">\n          <button\n            className=\"btn btn-primary fw-bold mt-4\"\n            onClick={this.handleSubmit}\n            disabled={!inputsAreAllValid}\n          >\n            Change Password\n          </button>\n        </div>\n      </Form>\n    );\n  }\n}\n\nexport default withRouter(Password);\n"]},"metadata":{},"sourceType":"module"}