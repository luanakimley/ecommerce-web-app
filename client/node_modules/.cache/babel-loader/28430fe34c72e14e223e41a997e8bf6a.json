{"ast":null,"code":"import _classCallCheck from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from\"react\";import axios from\"axios\";import{SERVER_HOST}from\"../../config/global_constants\";import ShopBanner from\"../ShopBanner\";import OrderDetailsRow from\"./OrderDetailsRow\";import{Link,Redirect}from\"react-router-dom\";import Swal from\"sweetalert2\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var OrderReturn=/*#__PURE__*/function(_React$Component){_inherits(OrderReturn,_React$Component);var _super=_createSuper(OrderReturn);function OrderReturn(props){var _this;_classCallCheck(this,OrderReturn);_this=_super.call(this,props);_this.handleSelected=function(e){var selected=_this.state.selected;var index;if(e.target.checked){selected.push(e.target.value);var productObj=JSON.parse(e.target.value);axios.get(\"\".concat(SERVER_HOST,\"/products/\").concat(productObj.productId)).then(function(res){_this.setState({returnTotal:_this.state.returnTotal+productObj.quantity*res.data.price});});}else{index=selected.indexOf(e.target.value);selected.splice(index,1);var _productObj=JSON.parse(e.target.value);axios.get(\"\".concat(SERVER_HOST,\"/products/\").concat(_productObj.productId)).then(function(res){_this.setState({returnTotal:_this.state.returnTotal-_productObj.quantity*res.data.price});});}_this.setState({selected:selected});};_this.handleSubmit=function(e){axios.defaults.withCredentials=true;var today=new Date();var returnObj={orderId:_this.props.match.params.id,products:_this.state.selected,userId:localStorage._id,date:today,amount:_this.state.returnTotal};axios.post(\"\".concat(SERVER_HOST,\"/return\"),returnObj);Swal.fire({title:\"Product return confirmed\",text:\"Your return is being processed.\",icon:\"success\",showConfirmButton:false,timer:1500});_this.setState({redirect:true});};_this.state={products:[],user:\"\",photos:[],quantity:[],selected:[],_id:\"\",redirect:false,returnTotal:0};return _this;}_createClass(OrderReturn,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axios.defaults.withCredentials=true;axios.get(\"\".concat(SERVER_HOST,\"/orders/\").concat(this.props.match.params.id),{headers:{authorization:localStorage.token}}).then(function(res){_this2.setState({_id:res.data._id});var products=[];res.data.products.map(function(product,index){products[index]=product;_this2.setState({products:products});});if(res.data.userId!==\"undefined\"){axios.get(\"\".concat(SERVER_HOST,\"/users/\").concat(res.data.userId),{headers:{authorization:localStorage.token}}).then(function(res){_this2.setState({user:res.data.email});});}else{_this2.setState({user:\"guest\"});}});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column align-items-center\",children:[this.state.redirect?/*#__PURE__*/_jsx(Redirect,{to:\"/\"}):null,/*#__PURE__*/_jsx(ShopBanner,{title:\"Order Return\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"hgvcfwqx container p-3\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-center mb-4\",children:\"Select items to return\"}),this.state.products.map(function(product){return product.status!==\"Returned\"?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"input\",{onChange:_this3.handleSelected,type:\"checkbox\",value:JSON.stringify({productId:product.productId,quantity:product.quantity,_id:product._id}),className:\"mr-4\"}),/*#__PURE__*/_jsx(OrderDetailsRow,{product:product},product._id)]}):null;})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-light p-3 order-details-summary mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-center mb-4\",children:\"Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Refund method: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"float-right\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Paypal\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Shipping cost: \"}),/*#__PURE__*/_jsx(\"span\",{className:\"float-right\",children:\"FREE\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-item mt-3\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Refund total: \"}),/*#__PURE__*/_jsxs(\"span\",{className:\"float-right\",children:[\"\\u20AC\",this.state.returnTotal]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row m-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:this.handleSubmit,className:\"btn btn-success mr-3 mb-4 w-80\",disabled:this.state.selected.length===0,children:\"Confirm\"}),/*#__PURE__*/_jsx(Link,{to:{pathname:\"/orders/\".concat(this.props.match.params.id),state:{order:this.props.location.state.order}},children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger ml-3 mb-4 w-80\",children:\"Cancel\"})})]})]});}}]);return OrderReturn;}(React.Component);export default OrderReturn;","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/Purchases/OrderReturn.jsx"],"names":["React","axios","SERVER_HOST","ShopBanner","OrderDetailsRow","Link","Redirect","Swal","OrderReturn","props","handleSelected","e","selected","state","index","target","checked","push","value","productObj","JSON","parse","get","productId","then","res","setState","returnTotal","quantity","data","price","indexOf","splice","handleSubmit","defaults","withCredentials","today","Date","returnObj","orderId","match","params","id","products","userId","localStorage","_id","date","amount","post","fire","title","text","icon","showConfirmButton","timer","redirect","user","photos","headers","authorization","token","map","product","email","status","stringify","length","pathname","order","location","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport { SERVER_HOST } from \"../../config/global_constants\";\nimport ShopBanner from \"../ShopBanner\";\nimport OrderDetailsRow from \"./OrderDetailsRow\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport Swal from \"sweetalert2\";\n\nclass OrderReturn extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      products: [],\n      user: \"\",\n      photos: [],\n      quantity: [],\n      selected: [],\n      _id: \"\",\n      redirect: false,\n      returnTotal: 0,\n    };\n  }\n\n  handleSelected = (e) => {\n    let selected = this.state.selected;\n    let index;\n    if (e.target.checked) {\n      selected.push(e.target.value);\n\n      let productObj = JSON.parse(e.target.value);\n      axios\n        .get(`${SERVER_HOST}/products/${productObj.productId}`)\n        .then((res) => {\n          this.setState({\n            returnTotal:\n              this.state.returnTotal + productObj.quantity * res.data.price,\n          });\n        });\n    } else {\n      index = selected.indexOf(e.target.value);\n      selected.splice(index, 1);\n\n      let productObj = JSON.parse(e.target.value);\n      axios\n        .get(`${SERVER_HOST}/products/${productObj.productId}`)\n        .then((res) => {\n          this.setState({\n            returnTotal:\n              this.state.returnTotal - productObj.quantity * res.data.price,\n          });\n        });\n    }\n    this.setState({ selected: selected });\n  };\n\n  handleSubmit = (e) => {\n    axios.defaults.withCredentials = true;\n    let today = new Date();\n\n    let returnObj = {\n      orderId: this.props.match.params.id,\n      products: this.state.selected,\n      userId: localStorage._id,\n      date: today,\n      amount: this.state.returnTotal,\n    };\n\n    axios.post(`${SERVER_HOST}/return`, returnObj);\n    Swal.fire({\n      title: \"Product return confirmed\",\n      text: \"Your return is being processed.\",\n      icon: \"success\",\n      showConfirmButton: false,\n      timer: 1500,\n    });\n    this.setState({ redirect: true });\n  };\n\n  componentDidMount() {\n    axios.defaults.withCredentials = true;\n\n    axios\n      .get(`${SERVER_HOST}/orders/${this.props.match.params.id}`, {\n        headers: { authorization: localStorage.token },\n      })\n      .then((res) => {\n        this.setState({ _id: res.data._id });\n        let products = [];\n        res.data.products.map((product, index) => {\n          products[index] = product;\n          this.setState({ products: products });\n        });\n\n        if (res.data.userId !== \"undefined\") {\n          axios\n            .get(`${SERVER_HOST}/users/${res.data.userId}`, {\n              headers: { authorization: localStorage.token },\n            })\n            .then((res) => {\n              this.setState({ user: res.data.email });\n            });\n        } else {\n          this.setState({ user: \"guest\" });\n        }\n      });\n  }\n\n  render() {\n    return (\n      <div className=\"d-flex flex-column align-items-center\">\n        {this.state.redirect ? <Redirect to=\"/\" /> : null}\n        <ShopBanner title=\"Order Return\" />\n        <div className=\"hgvcfwqx container p-3\">\n          <h4 className=\"text-center mb-4\">Select items to return</h4>\n          {this.state.products.map((product) =>\n            product.status !== \"Returned\" ? (\n              <div className=\"d-flex align-items-center\">\n                <input\n                  onChange={this.handleSelected}\n                  type=\"checkbox\"\n                  value={JSON.stringify({\n                    productId: product.productId,\n                    quantity: product.quantity,\n                    _id: product._id,\n                  })}\n                  className=\"mr-4\"\n                />\n                <OrderDetailsRow key={product._id} product={product} />\n              </div>\n            ) : null\n          )}\n        </div>\n\n        <div className=\"bg-light p-3 order-details-summary mb-4\">\n          <h4 className=\"text-center mb-4\">Summary</h4>\n          <div className=\"summary-item\">\n            <span>Refund method: </span>\n            <span className=\"float-right\">\n              <strong>Paypal</strong>\n            </span>\n          </div>\n          <div className=\"summary-item\">\n            <span>Shipping cost: </span>\n            <span className=\"float-right\">FREE</span>\n          </div>\n          <div className=\"summary-item mt-3\">\n            <span>Refund total: </span>\n            <span className=\"float-right\">€{this.state.returnTotal}</span>\n          </div>\n        </div>\n        <div className=\"d-flex flex-row m-3\">\n          <button\n            onClick={this.handleSubmit}\n            className=\"btn btn-success mr-3 mb-4 w-80\"\n            disabled={this.state.selected.length === 0}\n          >\n            Confirm\n          </button>\n          <Link\n            to={{\n              pathname: `/orders/${this.props.match.params.id}`,\n              state: {\n                order: this.props.location.state.order,\n              },\n            }}\n          >\n            <button className=\"btn btn-danger ml-3 mb-4 w-80\">Cancel</button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default OrderReturn;\n"]},"metadata":{},"sourceType":"module"}