{"ast":null,"code":"import _classCallCheck from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import axios from\"axios\";import React from\"react\";import{Redirect,withRouter}from\"react-router-dom\";import{SERVER_HOST,ACCESS_LEVEL_GUEST}from\"../../config/global_constants\";import Swal from\"sweetalert2\";import{jsx as _jsx}from\"react/jsx-runtime\";var AddToCart=/*#__PURE__*/function(_React$Component){_inherits(AddToCart,_React$Component);var _super=_createSuper(AddToCart);function AddToCart(props){var _this;_classCallCheck(this,AddToCart);_this=_super.call(this,props);_this.state={redirectToHome:false,navTo:\"\"};return _this;}_createClass(AddToCart,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var state=this.props.location.state;this.setState({navTo:state.navTo});var cartObject={productId:this.props.match.params.id,userId:localStorage._id,quantity:1,productPrice:this.props.match.params.price};if(localStorage.accessLevel>parseInt(ACCESS_LEVEL_GUEST)){axios.get(\"\".concat(SERVER_HOST,\"/cart/\").concat(this.props.match.params.id,\"/\").concat(localStorage._id)).then(function(res){if(res.data){if(_this2.props.match.params.stock<=res.data.quantity){Swal.fire({title:\"Product not added\",text:\"Not enough stock\",icon:\"error\",showConfirmButton:true,confirmButtonColor:\"#123c69\"}).then(_this2.setState({redirectToHome:true}));}else{axios.put(\"\".concat(SERVER_HOST,\"/cart/increaseQuantity/\").concat(res.data._id,\"/\").concat(_this2.props.match.params.id));Swal.fire({title:\"Product added to shopping cart\",text:\"The product has been added.\",icon:\"success\",showConfirmButton:false,timer:1500});_this2.setState({redirectToHome:true});}}else{axios.post(\"\".concat(SERVER_HOST,\"/cart/\").concat(_this2.props.match.params.id),cartObject);Swal.fire({title:\"Product added to shopping cart\",text:\"The product has been added.\",icon:\"success\",showConfirmButton:false,timer:1500});_this2.setState({redirectToHome:true});}});}else{if(localStorage.cart===\"null\"){Swal.fire({title:\"Product added to shopping cart\",text:\"The product has been added.\",icon:\"success\",showConfirmButton:false,timer:1500}).then(function(res){_this2.setState({redirectToHome:true});window.location.reload(false);});var cartArray=[];cartArray.push(cartObject);localStorage.cart=JSON.stringify(cartArray);}else{var curCart=JSON.parse(localStorage.cart);var quantity;curCart.forEach(function(item){if(item.productId===cartObject.productId){quantity=item.quantity;}});if(this.props.match.params.stock<=quantity){Swal.fire({title:\"Product not added\",text:\"Not enough stock\",icon:\"error\",showConfirmButton:true,confirmButtonColor:\"#123c69\"}).then(this.setState({redirectToHome:true}));}else{var exist=false;curCart.forEach(function(item){if(item.productId===cartObject.productId){item.quantity++;exist=true;}});if(!exist){curCart.push(cartObject);}localStorage.cart=JSON.stringify(curCart);Swal.fire({title:\"Product added to shopping cart\",text:\"The product has been added.\",icon:\"success\",showConfirmButton:false,timer:1500}).then(function(res){_this2.setState({redirectToHome:true});window.location.reload(false);});}}}}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(\"div\",{children:this.state.redirectToHome?/*#__PURE__*/_jsx(Redirect,{to:this.state.navTo}):null});}}]);return AddToCart;}(React.Component);export default withRouter(AddToCart);","map":{"version":3,"sources":["/Users/luanakimley/nodejs-projects/ecommerce-web-app/client/src/components/ShoppingCart/AddToCart.jsx"],"names":["axios","React","Redirect","withRouter","SERVER_HOST","ACCESS_LEVEL_GUEST","Swal","AddToCart","props","state","redirectToHome","navTo","location","setState","cartObject","productId","match","params","id","userId","localStorage","_id","quantity","productPrice","price","accessLevel","parseInt","get","then","res","data","stock","fire","title","text","icon","showConfirmButton","confirmButtonColor","put","timer","post","cart","window","reload","cartArray","push","JSON","stringify","curCart","parse","forEach","item","exist","Component"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport React from \"react\";\nimport { Redirect, withRouter } from \"react-router-dom\";\nimport { SERVER_HOST, ACCESS_LEVEL_GUEST } from \"../../config/global_constants\";\nimport Swal from \"sweetalert2\";\n\nclass AddToCart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      redirectToHome: false,\n      navTo: \"\",\n    };\n  }\n\n  componentDidMount() {\n    const { state } = this.props.location;\n    this.setState({ navTo: state.navTo });\n\n    const cartObject = {\n      productId: this.props.match.params.id,\n      userId: localStorage._id,\n      quantity: 1,\n      productPrice: this.props.match.params.price,\n    };\n\n    if (localStorage.accessLevel > parseInt(ACCESS_LEVEL_GUEST)) {\n      axios\n        .get(\n          `${SERVER_HOST}/cart/${this.props.match.params.id}/${localStorage._id}`\n        )\n        .then((res) => {\n          if (res.data) {\n            if (this.props.match.params.stock <= res.data.quantity) {\n              Swal.fire({\n                title: \"Product not added\",\n                text: \"Not enough stock\",\n                icon: \"error\",\n                showConfirmButton: true,\n                confirmButtonColor: \"#123c69\",\n              }).then(this.setState({ redirectToHome: true }));\n            } else {\n              axios.put(\n                `${SERVER_HOST}/cart/increaseQuantity/${res.data._id}/${this.props.match.params.id}`\n              );\n              Swal.fire({\n                title: `Product added to shopping cart`,\n                text: \"The product has been added.\",\n                icon: \"success\",\n                showConfirmButton: false,\n                timer: 1500,\n              });\n              this.setState({ redirectToHome: true });\n            }\n          } else {\n            axios.post(\n              `${SERVER_HOST}/cart/${this.props.match.params.id}`,\n              cartObject\n            );\n            Swal.fire({\n              title: `Product added to shopping cart`,\n              text: \"The product has been added.\",\n              icon: \"success\",\n              showConfirmButton: false,\n              timer: 1500,\n            });\n            this.setState({ redirectToHome: true });\n          }\n        });\n    } else {\n      if (localStorage.cart === \"null\") {\n        Swal.fire({\n          title: `Product added to shopping cart`,\n          text: \"The product has been added.\",\n          icon: \"success\",\n          showConfirmButton: false,\n          timer: 1500,\n        }).then((res) => {\n          this.setState({ redirectToHome: true });\n          window.location.reload(false);\n        });\n        const cartArray = [];\n        cartArray.push(cartObject);\n        localStorage.cart = JSON.stringify(cartArray);\n      } else {\n        const curCart = JSON.parse(localStorage.cart);\n        let quantity;\n        curCart.forEach((item) => {\n          if (item.productId === cartObject.productId) {\n            quantity = item.quantity;\n          }\n        });\n        if (this.props.match.params.stock <= quantity) {\n          Swal.fire({\n            title: \"Product not added\",\n            text: \"Not enough stock\",\n            icon: \"error\",\n            showConfirmButton: true,\n            confirmButtonColor: \"#123c69\",\n          }).then(this.setState({ redirectToHome: true }));\n        } else {\n          let exist = false;\n          curCart.forEach((item) => {\n            if (item.productId === cartObject.productId) {\n              item.quantity++;\n              exist = true;\n            }\n          });\n          if (!exist) {\n            curCart.push(cartObject);\n          }\n\n          localStorage.cart = JSON.stringify(curCart);\n          Swal.fire({\n            title: `Product added to shopping cart`,\n            text: \"The product has been added.\",\n            icon: \"success\",\n            showConfirmButton: false,\n            timer: 1500,\n          }).then((res) => {\n            this.setState({ redirectToHome: true });\n            window.location.reload(false);\n          });\n        }\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        {this.state.redirectToHome ? <Redirect to={this.state.navTo} /> : null}\n      </div>\n    );\n  }\n}\n\nexport default withRouter(AddToCart);\n"]},"metadata":{},"sourceType":"module"}